<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wiki.unrealengine.com</title>
    <meta name="description" content="A static site pulled from the internet archive">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css" as="style"><link rel="preload" href="/wiki.unrealengine.com/assets/js/app.aaf63946.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/2.4f53495e.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/464.8f174b52.js" as="script">
    <link rel="stylesheet" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki.unrealengine.com/" class="home-link router-link-active"><!----> <span class="site-name">wiki.unrealengine.com</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Dynamic Depth of Field - Epic Wiki</p> <h1 id="dynamic-depth-of-field"><a href="#dynamic-depth-of-field" class="header-anchor">#</a> Dynamic Depth of Field</h1> <p><strong>Rate this Article:</strong></p> <p>0.00</p> <p><img src="/extensions/VoteNY/images/star_off.gif" alt=""><img src="/extensions/VoteNY/images/star_off.gif" alt=""><img src="/extensions/VoteNY/images/star_off.gif" alt=""><img src="/extensions/VoteNY/images/star_off.gif" alt=""><img src="/extensions/VoteNY/images/star_off.gif" alt=""></p> <p>Approved for Versions:4.0 to 4.7.5</p> <h2 id="contents"><a href="#contents" class="header-anchor">#</a> Contents</h2> <ul><li><a href="#Overview">1 Overview</a></li> <li><a href="#Blueprint_Setup">2 Blueprint Setup</a> <ul><li><a href="#Events">2.1 Events</a></li> <li><a href="#Trace_Hit_Result_and_Focus_Distance">2.2 Trace Hit Result and Focus Distance</a></li> <li><a href="#Post_Process_Settings">2.3 Post Process Settings</a></li></ul></li> <li><a href="#Final_Result_and_Notes">3 Final Result and Notes</a></li></ul> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p><a href="/File:DoF_5.jpg"><img src="https://d26ilriwvtzlb.cloudfront.net/e/e9/DoF_5.jpg" alt="DoF 5.jpg"></a></p> <p>Dynamic depth of field is an effect that can be used in FPS games to blur the background while reloading a weapon or focusing on the target as the player aims through iron sights of their weapon while blurring the rest of the screen. It can also be used to create a camera that you can use for taking screenshots for portfolio or any other reason you would want DoF effect without bothering with all the post process adjustments every time.</p> <p>Here I'll give you the bare bones of how to implement this effect to a player camera using <strong>TP_FirstPersonBP</strong> template project, which later on you can implement on any camera and change the settings depending on your needs.</p> <h2 id="blueprint-setup"><a href="#blueprint-setup" class="header-anchor">#</a> Blueprint Setup</h2> <p><a href="/File:DoF_6.JPG"><img src="https://d3ar1piqh1oeli.cloudfront.net/6/6e/DoF_6.JPG/360px-DoF_6.JPG" alt="DoF 6.JPG"></a></p> <p><a href="/File:DoF_6.JPG" title="Enlarge"><img src="/skins/common/images/magnify-clip.png" alt=""></a></p> <p>Here you can see the overall network inside the character blueprint's Event graph, if you have experience with Blueprints and just want to get the network and recreate it right away. Now more details.</p> <h3 id="events"><a href="#events" class="header-anchor">#</a> Events</h3> <p><a href="/File:DoF_7.JPG"><img src="https://d26ilriwvtzlb.cloudfront.net/2/21/DoF_7.JPG" alt="DoF 7.JPG"></a></p> <p>We are going to be using two events, <strong>Event Tick</strong> and an <strong>Input</strong> event. We don't want to have this effect all the time in this case, so we use <strong>Right Mouse Button</strong> to enable Tick to fire a <em>line trace</em> from the camera which will tell us if/where/which object is the center of focus. And when we release the input, it will reverse the Timeline and stop the effect. Event Tick will also update the camera's post process settings as we will see in the following sections.</p> <p>Trace Distance node is a collapsed graph to reduce the crowd in the network. You can see the expanded view down below:</p> <p><a href="/File:Collapsed_TraceDistance.JPG"><img src="https://d3ar1piqh1oeli.cloudfront.net/0/0f/Collapsed_TraceDistance.JPG/720px-Collapsed_TraceDistance.JPG" alt="Collapsed TraceDistance.JPG"></a></p> <p><a href="/File:Collapsed_TraceDistance.JPG" title="Enlarge"><img src="/skins/common/images/magnify-clip.png" alt=""></a></p> <p>Return Value 1 is the camera's location and 5000 is the distance we are going to be tracing.</p> <h3 id="trace-hit-result-and-focus-distance"><a href="#trace-hit-result-and-focus-distance" class="header-anchor">#</a> Trace Hit Result and Focus Distance</h3> <p><a href="/File:DoF_8.JPG"><img src="https://d26ilriwvtzlb.cloudfront.net/2/2a/DoF_8.JPG" alt="DoF 8.JPG"></a></p> <p>We are going to use a 1 second long <strong>Timeline</strong> track going from 0.0 to 0.5 to set the intensity of depth of field effect(which basically activates/deactivates the effect) After a trace happens every tick we check the return value(boolean).If it is true then it continues the rest of the calculations. If not, it reverses the Timeline to stop the effect.</p> <p>Considering the trace hit an object, we break that result so that we can get the <strong>Hit Location</strong>. And to get the distance between the camera and the hit location we will use a macro like this:</p> <p><a href="/File:FocusDistance_Macro.JPG"><img src="https://d26ilriwvtzlb.cloudfront.net/8/83/FocusDistance_Macro.JPG" alt="FocusDistance Macro.JPG"></a></p> <p><a href="/File:FocusDistance_Macro.JPG" title="Enlarge"><img src="/skins/common/images/magnify-clip.png" alt=""></a></p> <p>Or, you can use Vector Length node instead if you prefer. Subtract location of the camera from focus location and get the length of that output, and you will get the distance.</p> <p>Now that we have the information we need we can use it to manipulate our camera's depth of field settings.</p> <h3 id="post-process-settings"><a href="#post-process-settings" class="header-anchor">#</a> Post Process Settings</h3> <p><a href="/File:DoF_9.JPG"><img src="https://d26ilriwvtzlb.cloudfront.net/9/9e/DoF_9.JPG" alt="DoF 9.JPG"></a></p> <p>First we get the post process settings of the camera, which will give us the last focal distance so that we can use it for a soft blend when the trace hits points too far from each other.</p> <p>To get the Break/Make post process nodes;</p> <ol><li><strong>Get First Person Camera</strong></li> <li>Drag from first person camera and <strong>Get Post Process Settings</strong></li> <li>Drag from post process settings and you'll see <strong>Break and Make PostProcessSettings</strong> nodes</li></ol> <p>Now in the details panel of Break Postprocesssettings node enable only Depth of Field Focal Distance setting. Currently(version 4.1.1) post process setting nodes are a little messy so you'll have to turn all of the rest of the settings manually for easier control. When we drag from Depth of Field Focal Distance and <strong>Set</strong> the variable(named <em>Last Focus</em>) it gets stored as the last focal distance. And finally in order to get a smooth blend between the last focus distance and the current hit location we use <strong>FInterp To</strong> node.</p> <h2 id="final-result-and-notes"><a href="#final-result-and-notes" class="header-anchor">#</a> Final Result and Notes</h2> <p>When it's all done, this is what you will get every time you press and hold the right mouse button:</p> <p><a href="https://www.youtube.com/watch?v=rEargI8dNFk" target="_blank" rel="noopener noreferrer">Final Result<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>You can download a sample project icluding a character BP with this function <a href="https://drive.google.com/file/d/0B0LlbsIm3HuuTzNQZUJSQmkzR0k/view?usp=sharing" target="_blank" rel="noopener noreferrer"><strong>here</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p><strong>Notes:</strong></p> <ul><li>Setting the interp speed depending on the distance is optional, but highly suggested.</li> <li>You can adjust Near and Far Transition depending on how you want it to look like. Add distance for softer transition / Subtract distance for sharper transition.</li></ul> <p>Retrieved from &quot;<a href="https://wiki.unrealengine.com/index.php?title=Dynamic_Depth_of_Field&amp;oldid=14724" target="_blank" rel="noopener noreferrer">https://wiki.unrealengine.com/index.php?title=Dynamic_Depth_of_Field&amp;oldid=14724<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;</p> <p><a href="/Special:Categories" title="Special:Categories">Categories</a>:</p> <ul><li><a href="/Category:Tutorials" title="Category:Tutorials">Tutorials</a></li> <li><a href="/Category:Blueprint" title="Category:Blueprint">Blueprint</a></li></ul> <p>Hidden category:</p> <ul><li><a href="/Category:Templates" title="Category:Templates">Templates</a></li></ul> <p><img src="https://tracking.unrealengine.com/track.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wiki.unrealengine.com/assets/js/app.aaf63946.js" defer></script><script src="/wiki.unrealengine.com/assets/js/2.4f53495e.js" defer></script><script src="/wiki.unrealengine.com/assets/js/464.8f174b52.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wiki.unrealengine.com</title>
    <meta name="description" content="A static site pulled from the internet archive">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css" as="style"><link rel="preload" href="/wiki.unrealengine.com/assets/js/app.aaf63946.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/2.4f53495e.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/556.f5898c67.js" as="script">
    <link rel="stylesheet" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki.unrealengine.com/" class="home-link router-link-active"><!----> <span class="site-name">wiki.unrealengine.com</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>HUD, Canvas, Code Sample of 800+ Lines, Create Buttons &amp; Draw Materials - Epic Wiki</p> <h1 id="hud-canvas-code-sample-of-800-lines-create-buttons-draw-materials"><a href="#hud-canvas-code-sample-of-800-lines-create-buttons-draw-materials" class="header-anchor">#</a> HUD, Canvas, Code Sample of 800+ Lines, Create Buttons &amp; Draw Materials</h1> <p>From Epic Wiki</p> <p>Jump to: <a href="#mw-navigation">navigation</a>, <a href="#p-search">search</a></p> <h2 id="contents"><a href="#contents" class="header-anchor">#</a> Contents</h2> <ul><li><a href="#Overview">1 Overview</a> <ul><li><a href="#Multiple_convenience_functions_for">1.1 Multiple convenience functions for</a></li> <li><a href="#Transparency">1.2 Transparency</a></li> <li><a href="#Centering">1.3 Centering</a></li> <li><a href="#Rest_of_Game_Code_Integration">1.4 Rest of Game Code Integration</a></li> <li><a href="#Player_Keyboard.2CMouse.2CController_Input">1.5 Player Keyboard,Mouse,Controller Input</a></li> <li><a href="#Text_Size">1.6 Text Size</a></li> <li><a href="#Buttons">1.7 Buttons</a></li> <li><a href="#Cursor">1.8 Cursor</a></li> <li><a href="#Tooltips">1.9 Tooltips</a></li> <li><a href="#Drawing_Images.2FTextures.2FMaterials">1.10 Drawing Images/Textures/Materials</a></li></ul></li> <li><a href="#Video">2 Video</a> <ul><li><a href="#Customizing_the_Appearance">2.1 Customizing the Appearance</a></li></ul></li> <li><a href="#Credit">3 Credit</a></li> <li><a href="#Pre-requisites">4 Pre-requisites</a></li> <li><a href="#C.2B.2B_Code">5 C++ Code</a> <ul><li><a href="#JoyHUD.h">5.1 JoyHUD.h</a></li> <li><a href="#JoyHUD.cpp">5.2 JoyHUD.cpp</a></li></ul></li> <li><a href="#Compile_and_Make_BP">6 Compile and Make BP</a></li> <li><a href="#Adding_The_Graphics">7 Adding The Graphics</a></li> <li><a href="#Conclusion">8 Conclusion</a></li></ul> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p><em>Code Author:</em> <a href="/User:Rama" title="User:Rama">Rama</a> (<a href="/User_talk:Rama" title="User talk:Rama">talk</a>)</p> <p>Dear Community,</p> <p>In this tutorial I am giving you a fully functional HUD class that is 800+ lines of UE4 C++ code.</p> <p><strong>Features of this sample HUD class include:</strong></p> <h3 id="multiple-convenience-functions-for"><a href="#multiple-convenience-functions-for" class="header-anchor">#</a> Multiple convenience functions for</h3> <ul><li>drawing textures</li> <li>drawing materials</li> <li>drawing lines</li> <li>drawing rectangles</li> <li>drawing text</li></ul> <p>The functions use the new UE4 method of using CanvasItems.</p> <h3 id="transparency"><a href="#transparency" class="header-anchor">#</a> Transparency</h3> <p>Every HUD element I show in my sample has at least some transparency!</p> <p>The main HUD menu graphic is actually mostly transparent, except for the edges!</p> <h3 id="centering"><a href="#centering" class="header-anchor">#</a> Centering</h3> <ul><li>how to draw stuff centered in the screen (used by confirm dialog)</li></ul> <h3 id="rest-of-game-code-integration"><a href="#rest-of-game-code-integration" class="header-anchor">#</a> Rest of Game Code Integration</h3> <p>I have code in the tutorial to show you how to get a reference to your custom PC or Character class from within the HUD.</p> <p>From your PC reference you can get access to your custom Game Mode and Game State classes (using the Cast&lt;&gt; code I show in tutorial PostInit)</p> <h3 id="player-keyboard-mouse-controller-input"><a href="#player-keyboard-mouse-controller-input" class="header-anchor">#</a> Player Keyboard,Mouse,Controller Input</h3> <p>How to capture player key presses for ANY key,mouse,controller that you want from within the HUD</p> <p><strong>Key Controls used in this tutorial code:</strong></p> <ul><li>ESC: clears the screen lock so camera will move with cursor.</li> <li>F: Toggle screen lock so only the cursor moves as player moves the mouse.</li> <li>H: Toggles hiding the HUD</li> <li>LMB: Clicks on buttons</li> <li>Y: Confirm yes if confirm dialog open</li> <li>N: Cancel if confirm dialog is open</li></ul> <h3 id="text-size"><a href="#text-size" class="header-anchor">#</a> Text Size</h3> <p>How to measure text, accounting for scaling and font size, to size backgrounds,buttons,tooltips appropriately</p> <h3 id="buttons"><a href="#buttons" class="header-anchor">#</a> Buttons</h3> <p>A button system and corresponding USTRUCT</p> <h3 id="cursor"><a href="#cursor" class="header-anchor">#</a> Cursor</h3> <p>How to draw cursor that player can move in-game</p> <p>How to change cursor when hovering over button</p> <h3 id="tooltips"><a href="#tooltips" class="header-anchor">#</a> Tooltips</h3> <p>Button tooltips</p> <h3 id="drawing-images-textures-materials"><a href="#drawing-images-textures-materials" class="header-anchor">#</a> Drawing Images/Textures/Materials</h3> <p>Drawing custom button and menu backgrounds that come from textures/materials</p> <h2 id="video"><a href="#video" class="header-anchor">#</a> Video</h2> <p>Here is a video of this exact code in action!</p> <h3 id="customizing-the-appearance"><a href="#customizing-the-appearance" class="header-anchor">#</a> Customizing the Appearance</h3> <p>Note that I made my own fonts and cursors and materials as seen in video, you can make your own appearance using same codeÂ ðŸ˜ƒ</p> <h2 id="credit"><a href="#credit" class="header-anchor">#</a> Credit</h2> <p>Feel free to use this as a template/foundation for making a c++ HUD-based GUI for your game!</p> <p>Please do give me credit in some appropriate way for this base-line code contribution.</p> <p>All of this code is of my own creation, and I am using functions made only by Epic.</p> <p><strong>Why Did I Do All This?</strong></p> <p>I have implemented a very featured GUI for my game using only UE4 C++ and the HUD class!</p> <p>I was able to create from scratch everything I wanted, including scrollable panels and an in-game file system.</p> <p>I wanted to demo for you how this can be done, so that you can do this in your game too!</p> <p>Constructing this tutorial for you took me about 5 hours, 2 hours of which was just documation / video</p> <p>Adding buttons and such to this code should only take you minutes.</p> <p>Integrating this code with your game engine will be easy, you can get a reference to the owning Character or the player controller from within the HUD class itself.</p> <h2 id="pre-requisites"><a href="#pre-requisites" class="header-anchor">#</a> Pre-requisites</h2> <p>Make at least one font of your own, right click and make a new font asset.</p> <p>I recommend a large default size like 36, as explained in the code below.</p> <h2 id="c-code"><a href="#c-code" class="header-anchor">#</a> C++ Code</h2> <p>The code below assumes you have created a now Class named &quot;JoyHUD&quot;. If you &quot;add code to project&quot; from the Editor, then you will need to replace the default files with the code below.</p> <h3 id="joyhud-h"><a href="#joyhud-h" class="header-anchor">#</a> JoyHUD.h</h3> <p>// Copyright 1998-2013 Epic Games, Inc. All Rights Reserved.
Â 
//VictoryHUD extension by Rama
Â 
#pragma once
Â 
#include &quot;JoyHUD.generated.h&quot;
Â 
USTRUCT()
struct FJoyButtonStruct
{
GENERATED_USTRUCT_BODY()
Â 
//Vars
int32 		type;
FString	toolTip;
float 		minX;
float 		maxX;
float 		minY;
float 		maxY;
Â 
//~
Â 
//default properties
Â 
FJoyButtonStruct()
{
type 			= -1;
toolTip 		= &quot;&quot;;
minX 			= 0;
maxX 			= 0;
minY 			= 0;
maxY 			= 0;
}
};
Â 
UCLASS()
class AJoyHUD : public AHUD
{
GENERATED_UCLASS_BODY()
Â 
// Font
//		I recommend creating the font at a high resolution / size like 36
//			then you can scale down the font as needed to any size of your choice
Â 
/** Verdana */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=JoyHUD)
UFont* VerdanaFont;
Â 
/** Put Roboto Here */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=JoyHUD)
UFont* UE4Font;
Â 
/** Font Scaling Used By Your HUD Code */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=JoyHUD)
float DefaultFontScale;
Â 
/** HUD Scaling */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=JoyHUD)
float GlobalHUDMult;
Â 
// T2D
/** Cursor */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=T2D)
UTexture2D* CursorMain;
Â 
/** Hovering */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=T2D)
UTexture2D* CursorHoveringButton;
Â 
/** Button */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=T2D)
UTexture2D* ButtonBackground;
Â 
// Materials
/** Events */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=Materials)
UMaterialInterface* MaterialBackground;
Â 
//
Â 
/* Draw Hud? */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=Options)
bool DontDrawHUD;
Â 
//Cursor
public:
FVector2D MouseLocation;
void DrawHUD_DrawCursor();
Â 
//Buttons
public:
TArray&lt;FJoyButtonStruct&gt; ButtonsMain;
TArray&lt;FJoyButtonStruct&gt; ButtonsConfirm;
Â 
//Cursor In buttons
void DrawHUD_CheckCursorInButtons();
void CheckCursorInButtonsMain();
void CheckCursorInButtonsConfirm();
Â 
const FJoyButtonStruct* CurCheckButton;
int32 CheckCursorInButton(const TArray&lt;FJoyButtonStruct&gt;&amp; ButtonArray);
int32 ClickedButtonType;
//States
bool ConfirmDialogOpen;
bool InMainMenu;
Â 
int32 		ActiveButton_Type;
FString 	ActiveButton_Tip;
bool CursorHoveringInButton;
//Colors
public:
const FLinearColor * ColorPtr;
Â 
//Colors
static const FColor		FColorBlack;
static const FColor		FColorRed;
static const FColor		FColorYellow;
static const FColor		FColorBlue;
static const FColor		FColor_White;
Â 
static const FLinearColor LC_Black;
static const FLinearColor LC_Pink;
static const FLinearColor LC_Red;
static const FLinearColor LC_Yellow;
//FString
public:
Â 
//`Titles
static const FString S_Title_Main;
static const FString S_Title_Confirm;
//`Button Text
static const FString S_Button_Restart;
static const FString S_Button_Exit;
Â 
// Utility
Â 
//Stop Camera From Moving With Mouse
FORCEINLINE void SetCursorMoveOnly(bool CursorOnly)
{
if(!ThePC) return;
//
ThePC-&gt;SetIgnoreLookInput(CursorOnly);
Â 
}
Â 
//DrawLine
FORCEINLINE void DrawJoyLine
(
const FVector2D&amp; Start,
const FVector2D&amp; End,
const FLinearColor&amp; TheColor,
const float&amp; Thick
)
{
if (!Canvas) return;
//
Â 
FCanvasLineItem NewLine(Start,End);
NewLine.SetColor(TheColor);
NewLine.LineThickness = Thick;
Canvas-&gt;DrawItem(NewLine);
}	
Â 
//~
Â 
FORCEINLINE void DrawJoyRect(
float X, float Y,
float Width, float Height,
const FLinearColor&amp; Color
)
{
if(!Canvas) return;
//
Â 
FCanvasTileItem RectItem(
FVector2D(X, Y),
FVector2D( Width, Height ),
Color
);
Â 
RectItem.BlendMode = SE_BLEND_Translucent;
Canvas-&gt;DrawItem(RectItem);
}
Â 
//~
Â 
//DrawText
FORCEINLINE void DrawJoyText(
UFont*	TheFont,
const FString&amp; TheStr,
const float&amp; X, const float&amp; Y,
const FLinearColor&amp; TheColor,
const float&amp; TheScale,
bool DrawOutline=false,
const FLinearColor OutlineColor=FLinearColor(0,0,0,1)
) {
if(!Canvas) return;
//
Â 
//Text and Font
FCanvasTextItem NewText(
FVector2D(X,Y),
FText::FromString(TheStr),
TheFont,
TheColor
);
Â 
//Text Scale
NewText.Scale.Set(TheScale,TheScale);
Â 
//Outline gets its alpha from the main color
NewText.bOutlined = true;
NewText.OutlineColor = OutlineColor;
NewText.OutlineColor.A = TheColor.A * 2;
Â 
//Draw
Canvas-&gt;DrawItem(NewText);
}
Â 
//~
//Draw Full Size Tile
FORCEINLINE void DrawFullSizeTile(UTexture2D* tex, float x, float y, const FColor&amp; Color)
{
if (!Canvas) return;
if (!tex) return;
//~~
Â 
Canvas-&gt;SetDrawColor(Color);
Â 
//Draw
Canvas-&gt;DrawTile(
tex, x, y, 0, //z pos
tex-&gt;GetSurfaceWidth(), //screen width
tex-&gt;GetSurfaceHeight(),  //screen height
0, //texture start width
0, //texture start height
tex-&gt;GetSurfaceWidth(), //texture width from start
tex-&gt;GetSurfaceHeight(), //texture height from start
BLEND_Translucent
);
}
Â 
//~
Â 
FORCEINLINE void VDrawTile(UTexture2D* tex, float x, float y, float screenX, float screenY, const FColor&amp; TheColor)
{
if (!Canvas) return;
if (!tex) return;
//~
Â 
Canvas-&gt;SetDrawColor(TheColor);
Â 
//Draw
Canvas-&gt;DrawTile(
tex, x, y, 0, //z pos
screenX, //screen width
screenY,  //screen height
0, //texture start width
0, //texture start height
tex-&gt;GetSurfaceWidth(), //texture width from start
tex-&gt;GetSurfaceHeight(), //texture height from start
BLEND_Translucent
);
}
Â 
//~
Â 
//Draw
public:
void DrawHUD_DrawDialogs();
Â 
//Menus
void DrawMainMenu();
void DrawConfirm();
Â 
//Buttons
void DrawMainMenuButtons();
void DrawConfirmButtons();
public:
void DrawToolTip();
Â 
//Core
public:
APlayerController* ThePC;
void PlayerInputChecks();
protected:
//Draw HUD
void DrawHUD_Reset();
virtual void DrawHUD() OVERRIDE;
Â 
/** after all game elements are created */
virtual void PostInitializeComponents() OVERRIDE;
Â 
Â 
};</p> <h3 id="joyhud-cpp"><a href="#joyhud-cpp" class="header-anchor">#</a> JoyHUD.cpp</h3> <p>// Copyright 1998-2013 Epic Games, Inc. All Rights Reserved.
Â 
//JoyHUD extension by Rama
Â 
#include &quot;VictoryGame.h&quot;   //Replace with a reference to the header file of your own project
Â 
#define BUTTONTYPE_MAIN_RESTART 	1
#define BUTTONTYPE_MAIN_EXIT 		2
Â 
#define BUTTONTYPE_CONFIRM_YES 	1
#define BUTTONTYPE_CONFIRM_NO 	2
Â 
#define CANVAS_WHITE if(Canvas) Canvas-&gt;SetDrawColor(FColor_White);
Â 
//Cursor Draw Offset
//		use this to position texture over the point of your cursor,
//			if the point is not at exactly 0,0
#define CURSOR_DRAW_OFFSET 3
Â 
//
//Static Consts
//
Â 
const FString AJoyHUD::S_Title_Main			= FString(&quot;Joy!&quot;);
const FString AJoyHUD::S_Title_Confirm		= FString(&quot;Exit Game?&quot;);
Â 
const FString AJoyHUD::S_Button_Restart	= FString(&quot;Restart&quot;);
const FString AJoyHUD::S_Button_Exit		= FString(&quot;Exit&quot;);
Â 
// Colors
const FColor AJoyHUD::FColorBlack 		= FColor(0,0,0,255);
const FColor AJoyHUD::FColorRed 			= FColor(255,0,0,255);
const FColor AJoyHUD::FColorYellow 		= FColor(255,255,0,255);
const FColor AJoyHUD::FColorBlue			= FColor(0,0,255,255);
const FColor AJoyHUD::FColor_White		= FColor(255,255,255,255);
// Backgrounds
const FLinearColor AJoyHUD::LC_Black 	= FLinearColor(0, 0, 0, 1);
const FLinearColor AJoyHUD::LC_Pink		= FLinearColor(1, 0, 1, 1);
const FLinearColor AJoyHUD::LC_Red 		= FLinearColor(1, 0, 0, 1);
const FLinearColor AJoyHUD::LC_Yellow 	= FLinearColor(1, 1, 0, 1);
Â 
AJoyHUD::AJoyHUD(const class FPostConstructInitializeProperties&amp; PCIP) : Super(PCIP)
{
//Draw HUD?
DontDrawHUD 		= false;
Â 
//States
ConfirmDialogOpen 	= false;
InMainMenu 			= true;
Â 
//Scale
GlobalHUDMult = 1;
DefaultFontScale = 0.7;   //scaling down a size 36 font
Â 
//	 I recommend creating fonts at a high resolution / size like 36
//			then you can scale down the font as needed to any size of your choice
Â 
// this avoids needing to make multiple fonts for different sizes, but have a high
// resolution when you use larger font sizes
Â 
}	
Â 
//Core
Â 
void AJoyHUD::PostInitializeComponents()
{
Super::PostInitializeComponents();
Â 
//Establish the PC
ThePC = GetOwningPlayerController();
Â 
//How to get a ref to your custom PC
//AYourPlayerController* YourChar = Cast<AYourPlayerController>(ThePC);
Â 
//How to Get The Character
//AYourCharacterClass* YourChar = Cast<AYourCharacterClass>(GetOwningPawn());
Â 
}
Â 
//===============
// Draw Dialogs
//===============
void AJoyHUD::DrawHUD_DrawDialogs()
{
DrawMainMenu();
if(ConfirmDialogOpen) DrawConfirm();
}
//Menus
void AJoyHUD::DrawMainMenu()
{
//Background
DrawMaterialSimple(
MaterialBackground,
10, 10,
256,
512,
1.3
);
Â 
//Menu Title
Â 
//Draw buttons
DrawMainMenuButtons();
}
void AJoyHUD::DrawConfirm()
{
//Blue rect with alpha 50%
DrawJoyRect(Canvas-&gt;SizeX/2 - 100, Canvas-&gt;SizeY/2 - 50,200,100,FLinearColor(0,0,1,0.2333));
Â 
//Confirm Title
Â 
//Draw buttons
DrawConfirmButtons();
}
Â 
//Buttons
void AJoyHUD::DrawMainMenuButtons()
{
//Start Point
float xStart = 100;
float yStart = 110;
Â 
//Background
VDrawTile(ButtonBackground,xStart,yStart,150,80,FColor(255,255,255,120)); //alpha 120/255
Â 
//Text
DrawJoyText(
VerdanaFont,&quot;Restart&quot;,xStart+30,yStart+20,
LC_Black, DefaultFontScale,
true,LC_Red
);
Â 
//Struct
//Add Button If Necessary
//		could be cleared and need refreshing if using a different menu
//			clear buttons with ButtonsMain.Empty()
if (ButtonsMain.Num() &lt; 1 )
{
FJoyButtonStruct newButton = FJoyButtonStruct();
newButton.type 			= BUTTONTYPE_MAIN_RESTART;
newButton.toolTip		= &quot;Restart the Game!&quot;;	
newButton.minX 			= xStart;
newButton.maxX 			= xStart + 150;		
newButton.minY 			= yStart;
newButton.maxY 			= yStart + 80;
Â 
//Add to correct array
ButtonsMain.Add(newButton);
}
Â 
Â 
xStart = 100;
yStart = 410;
Â 
VDrawTile(ButtonBackground,xStart,yStart,150,80,FColor(255,255,255,120)); //alpha 120/255
Â 
//Text
DrawJoyText(
VerdanaFont,&quot;Exit&quot;,xStart+55,yStart+20,
LC_Black, DefaultFontScale,
true,LC_Red
);
Â 
if (ButtonsMain.Num() &lt; 2 )
{
FJoyButtonStruct newButton = FJoyButtonStruct();
newButton.type 			= BUTTONTYPE_MAIN_EXIT;
newButton.toolTip			= &quot;Exit the Game!&quot;;	
newButton.minX 			= xStart;
newButton.maxX 			= xStart + 150;		
newButton.minY 			= yStart;
newButton.maxY 			= yStart + 80;
Â 
//Add to correct array
ButtonsMain.Add(newButton);
}
}
void AJoyHUD::DrawConfirmButtons()
{
float xStart = Canvas-&gt;SizeX/2 - 100;
float yStart = Canvas-&gt;SizeY/2 - 40;
Â 
//Highlighted?
if(ActiveButton_Type == BUTTONTYPE_CONFIRM_YES ) ColorPtr = &amp;LC_Pink;
else ColorPtr = &amp;LC_Yellow;
Â 
//Text
DrawJoyText(
VerdanaFont,&quot;Yes&quot;,xStart+30,yStart+20,
*ColorPtr, DefaultFontScale,
true
);
Â 
if (ButtonsConfirm.Num() &lt; 1 )
{
FJoyButtonStruct newButton = FJoyButtonStruct();
newButton.type 			= BUTTONTYPE_CONFIRM_YES ;
newButton.toolTip			= &quot;&quot;;	
newButton.minX 			= xStart;
newButton.maxX 			= xStart + 75;		
newButton.minY 			= yStart + 20;
newButton.maxY 			= yStart + 60;
Â 
//could use GetTextSize to streamline this
Â 
//Add to correct array
ButtonsConfirm.Add(newButton);
}
Â 
xStart = Canvas-&gt;SizeX/2 + 20;
yStart = Canvas-&gt;SizeY/2 - 40;
Â 
//Highlighted?
if(ActiveButton_Type == BUTTONTYPE_CONFIRM_NO) ColorPtr = &amp;LC_Black;
else ColorPtr = &amp;LC_Yellow;
Â 
//Text
DrawJoyText(
VerdanaFont,&quot;No&quot;,xStart+30,yStart+20,
*ColorPtr, DefaultFontScale,
true
);
Â 
if (ButtonsConfirm.Num() &lt; 2 )
{
FJoyButtonStruct newButton = FJoyButtonStruct();
newButton.type 			= BUTTONTYPE_CONFIRM_NO;
newButton.toolTip			= &quot;&quot;;	
newButton.minX 			= xStart;
newButton.maxX 			= xStart + 75;		
newButton.minY 			= yStart + 20;
newButton.maxY 			= yStart + 60;
Â 
//could use GetTextSize to streamline this
Â 
//Add to correct array
ButtonsConfirm.Add(newButton);
}
}
Â 
//===============
// Cursor In Buttons
//===============
int32 AJoyHUD::CheckCursorInButton(const TArray&lt;FJoyButtonStruct&gt;&amp; ButtonArray)
{
for(int32 b = 0; b &lt; ButtonArray.Num(); b++)
{
CurCheckButton = &amp;ButtonArray[b];
Â 
//check cursor in bounds
if (CurCheckButton-&gt;minX &lt;= MouseLocation.X &amp;&amp; MouseLocation.X &lt;= CurCheckButton-&gt;maxX &amp;&amp;
CurCheckButton-&gt;minY &lt;= MouseLocation.Y &amp;&amp; MouseLocation.Y &lt;= CurCheckButton-&gt;maxY )
{
Â 
//Active Button Type
ActiveButton_Type = CurCheckButton-&gt;type;
Â 
//Tool Tip
ActiveButton_Tip = CurCheckButton-&gt;toolTip;
Â 
//Change Cursor
CursorHoveringInButton = true;
Â 
//Mouse Clicked?
if (ThePC-&gt;WasInputKeyJustPressed(EKeys::LeftMouseButton))
{
return ActiveButton_Type;
//~~
//no need to check rest of buttons
}
}
}
Â 
//No Click Occurred This Tick
return -1;	
}
Â 
//Check Confirm
void AJoyHUD::CheckCursorInButtonsConfirm()
{
//Check Confirm Buttons
ClickedButtonType = CheckCursorInButton(ButtonsConfirm); //fills global ActiveButton_Type
Â 
if(ClickedButtonType == BUTTONTYPE_CONFIRM_YES )
{
ThePC-&gt;ConsoleCommand(&quot;Exit&quot;);
return;
}
if(ClickedButtonType == BUTTONTYPE_CONFIRM_NO)
{
ConfirmDialogOpen = false;
ButtonsConfirm.Empty(); //Buttons not needed anymore
return;
}
}
Â 
//Check Buttons
void AJoyHUD::CheckCursorInButtonsMain()
{
//Check Confirm Buttons
ClickedButtonType = CheckCursorInButton(ButtonsMain);
Â 
if(ClickedButtonType == BUTTONTYPE_MAIN_RESTART )
{
ThePC-&gt;ConsoleCommand(&quot;RestartLevel&quot;);
return;
}
if(ClickedButtonType == BUTTONTYPE_MAIN_EXIT)
{
ConfirmDialogOpen = true;
return;
}
}
void AJoyHUD::DrawHUD_CheckCursorInButtons()
{
if(ConfirmDialogOpen)
{
CheckCursorInButtonsConfirm();
Â 
//Take Focus Away From All Other buttons
return;
//~
}
Â 
//Main
CheckCursorInButtonsMain();
}
Â 
void AJoyHUD::DrawToolTip()
{
//if mouse is too far to right, draw from left instead
float xStart = MouseLocation.X + 150;
float yStart = MouseLocation.Y + 5;
Â 
//out vars
float RV_xLength;
float RV_yLength;
//Text Size
GetTextSize(
ActiveButton_Tip,
RV_xLength,
RV_yLength,
UE4Font,
DefaultFontScale * 2
);
Â 
// Decide Draw to Left or to the Right
Â 
//Draw to the Left
if (xStart + RV_xLength &gt;= Canvas-&gt;SizeX - 40)
{
xStart -= 150 + 140 + 64 + RV_xLength;
Â 
//If Text is too long, bring it closer to the cursor
if(xStart &lt; 33 ) xStart = 33;
}
Â 
//Background
DrawJoyRect(
xStart, yStart,
RV_xLength + 70,
80,
FLinearColor(0, 0, 1, 0.7) //alpha 0.7
);
Â 
//Tool Tip
DrawText(
ActiveButton_Tip,
LC_Pink,
xStart + 32, yStart + 20,
UE4Font,
DefaultFontScale * 2,			
false		//scale position of message with HUD scale
);
}
void AJoyHUD::DrawHUD_DrawCursor()
{
//Tool Tip
if(ActiveButton_Tip != &quot;&quot;) DrawToolTip();
Â 
//Cursor Hovering in a Button?
if (CursorHoveringInButton)
{
//pointer tex found?
if (!CursorHoveringButton) return;
DrawFullSizeTile(CursorHoveringButton, MouseLocation.X - CURSOR_DRAW_OFFSET, MouseLocation.Y - CURSOR_DRAW_OFFSET, FColor_White );
}
Â 
else
{
//cursor tex found?
if(!CursorMain) return;
DrawFullSizeTile(CursorMain, MouseLocation.X - CURSOR_DRAW_OFFSET, MouseLocation.Y - CURSOR_DRAW_OFFSET, FColor_White );
}
}
Â 
void AJoyHUD::PlayerInputChecks()
{
//check out this tutorial of mine for a list of all EKeys::
//http://forums.epicgames.com/threads/972861-Tutorials-C-for-UE4-Code-Samples-gt-gt-New-Video-Freeze-Render-When-Tabbed-Out?p=31660286&amp;viewfull=1#post31660286
Â 
if(ThePC-&gt;WasInputKeyJustPressed(EKeys::Escape))
{
SetCursorMoveOnly(false);
return;
}
if(ThePC-&gt;WasInputKeyJustPressed(EKeys::F))
{
SetCursorMoveOnly(!ThePC-&gt;IsLookInputIgnored());
return;
}
if(ThePC-&gt;WasInputKeyJustPressed(EKeys::H))
{
DontDrawHUD = !DontDrawHUD;
return;
}
Â 
//Confirm
if(ConfirmDialogOpen)
{
if(ThePC-&gt;WasInputKeyJustPressed(EKeys::Y))
{
ThePC-&gt;ConsoleCommand(&quot;Exit&quot;);
//could replace with function based on confirm context
Â 
return;
}
if(ThePC-&gt;WasInputKeyJustPressed(EKeys::N))
{
ConfirmDialogOpen = false;
ButtonsConfirm.Empty(); //Buttons not needed anymore
//Cancel Confirm
Â 
return;
}
}
}
Â 
void AJoyHUD::DrawHUD_Reset()
{
ActiveButton_Type 		= -1;
ActiveButton_Tip 		= &quot;&quot;;
CursorHoveringInButton 	= false;
}
Â 
void AJoyHUD::DrawHUD()
{
//==============================
//==============================
//==============================
//Have PC for Input Checks and Mouse Cursor?
if(!ThePC)
{
//Attempt to Reacquire PC
ThePC = GetOwningPlayerController();
Â 
//Could Not Obtain PC
if(!ThePC) return;
//~~
}
Â 
//Multiplayer Safety Check
if(!ThePC-&gt;PlayerInput) return; //not valid for first seconds of a multiplayer client
//~~
//==============================
//==============================
//==============================
Â 
//Player Input
PlayerInputChecks();
Â 
//Draw HUD?
if(DontDrawHUD) return;
//~~
Â 
//Super
Super::DrawHUD();
Â 
//No Canvas?
if(!Canvas) return;
//
Â 
//Reset States
DrawHUD_Reset();
Â 
//================
//Get New Mouse Position
//================
ThePC-&gt;GetMousePosition(MouseLocation.X,MouseLocation.Y);
Â 
//Cursor In Buttons
DrawHUD_CheckCursorInButtons();
Â 
//Draw Dialogs
DrawHUD_DrawDialogs();
Â 
//### Do Last ###
//Draw Cursor
DrawHUD_DrawCursor();
Â 
//Debugging Info
//ThePC-&gt;ClientMessage(&quot;HUD Loop Completed!&quot;);
}</AYourCharacterClass></AYourPlayerController></p> <h2 id="compile-and-make-bp"><a href="#compile-and-make-bp" class="header-anchor">#</a> Compile and Make BP</h2> <p>After you get the above to compile, you need to go into the editor and make a blueprint of this JoyHUD</p> <p>Then you need to go to your GameMode.cpp file and add this line:</p> <p>AYourGameMode::AYourGameMode(const class FPostConstructInitializeProperties&amp; PCIP)
: Super(PCIP)
{
// Right click on your HUD BP in the editor to find out what text should replace &quot;ThePath below&quot; - something like /Game/Blueprints/BP_JoyHUD
static ConstructorHelpers::FObjectFinder&lt;UBlueprint&gt; TheHUDOb(TEXT(&quot;ThePath&quot;));
if (TheHUDOb.Object != NULL)
{
HUDClass = (UClass*)TheHUDOb.Object-&gt;GeneratedClass;
}
Â 
//ThePath is the pasted text you get when you select the HUD BP in the editor and right click and say &quot;Copy Reference&quot;
}</p> <h2 id="adding-the-graphics"><a href="#adding-the-graphics" class="header-anchor">#</a> Adding The Graphics</h2> <p>Open the defaults of your new HUD BP and set the various assets!</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>Now you have the code to make your own button system, with tooltips, and draw textures and materials of any size and shape to the screen during game time!</p> <p>Using the DrawMaterial function you can make fancy effects in your game's GUI as you see in my video!</p> <p>You also have a solid foundation for a mouse/pointer driven GUI that responds to hover as well as click events!</p> <p>Enjoy!</p> <p><a href="/User:Rama" title="User:Rama">Rama</a> (<a href="/User_talk:Rama" title="User talk:Rama">talk</a>)</p> <p>Retrieved from &quot;<a href="https://wiki.unrealengine.com/index.php?title=HUD,_Canvas,_Code_Sample_of_800%2B_Lines,_Create_Buttons_%26_Draw_Materials&amp;oldid=4668" target="_blank" rel="noopener noreferrer">https://wiki.unrealengine.com/index.php?title=HUD,_Canvas,_Code_Sample_of_800%2B_Lines,_Create_Buttons_%26_Draw_Materials&amp;oldid=4668<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;</p> <p><a href="/Special:Categories" title="Special:Categories">Category</a>:</p> <ul><li><a href="/Category:Code" title="Category:Code">Code</a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wiki.unrealengine.com/assets/js/app.aaf63946.js" defer></script><script src="/wiki.unrealengine.com/assets/js/2.4f53495e.js" defer></script><script src="/wiki.unrealengine.com/assets/js/556.f5898c67.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wiki.unrealengine.com</title>
    <meta name="description" content="A static site pulled from the internet archive">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css" as="style"><link rel="preload" href="/wiki.unrealengine.com/assets/js/app.aaf63946.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/2.4f53495e.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/555.94521915.js" as="script">
    <link rel="stylesheet" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki.unrealengine.com/" class="home-link router-link-active"><!----> <span class="site-name">wiki.unrealengine.com</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>HTTP Administration Plugin Tutorial - Epic Wiki</p> <h1 id="http-administration-plugin-tutorial"><a href="#http-administration-plugin-tutorial" class="header-anchor">#</a> HTTP Administration Plugin Tutorial</h1> <h2 id="contents"><a href="#contents" class="header-anchor">#</a> Contents</h2> <ul><li><a href="#HTTP_Administration_Plugin_Tutorial">1 HTTP Administration Plugin Tutorial</a> <ul><li><a href="#Requirements">1.1 Requirements</a></li> <li><a href="#Skipping_to_the_fun_stuff">1.2 Skipping to the fun stuff</a></li> <li><a href="#Embedded_HTTP_mods">1.3 Embedded HTTP mods</a></li> <li><a href="#IModuleInterface">1.4 IModuleInterface</a></li> <li><a href="#HTTPAdmin_header">1.5 HTTPAdmin header</a></li> <li><a href="#HTTPAdmin_source_file">1.6 HTTPAdmin source file</a></li> <li><a href="#Easy_ways_to_improve_and_extend_this_example">1.7 Easy ways to improve and extend this example</a></li></ul></li></ul> <h1 id="http-administration-plugin-tutorial-2"><a href="#http-administration-plugin-tutorial-2" class="header-anchor">#</a> HTTP Administration Plugin Tutorial</h1> <p>This tutorial will teach you how to make a more complex C++ server-side mod for Unreal Tournament. If you have not completed <a href="/C%2B%2B_Game_Mode_Tutorial" title="C++ Game Mode Tutorial">C++_Game_Mode_Tutorial</a> or the <a href="/C%2B%2B_Mutator_Tutorial" title="C++ Mutator Tutorial">C++_Mutator_Tutorial</a>, I recommend you do that first.</p> <h2 id="requirements"><a href="#requirements" class="header-anchor">#</a> Requirements</h2> <ul><li>Engine version: 4.5.1</li> <li>Skill level: intermediate C++ knowledge</li></ul> <h2 id="skipping-to-the-fun-stuff"><a href="#skipping-to-the-fun-stuff" class="header-anchor">#</a> Skipping to the fun stuff</h2> <ul><li>There's already two C++ tutorials that go over build.cs and .uplugin file creation so I'm glossing over most things and just sticking to the things that might interest an advanced user right now.</li> <li>You can download the files required for this tutorial at <a href="https://github.com/knepleyp/UTHTTPAdmin" target="_blank" rel="noopener noreferrer">https://github.com/knepleyp/UTHTTPAdmin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>We'll use a slightly modified version of <a href="https://code.google.com/p/embedded-httpd/" target="_blank" rel="noopener noreferrer">https://code.google.com/p/embedded-httpd/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to get the HTTP interactions done</li></ul> <h2 id="embedded-http-mods"><a href="#embedded-http-mods" class="header-anchor">#</a> Embedded HTTP mods</h2> <ul><li>#include &quot;AllowWindowsPlatformTypes.h&quot; is required before #include &lt;winsock.h&quot; so types like INT and DWORD are allowed</li> <li>#include &quot;HTTPAdmin.h&quot; is required in httpd.cpp because of Unreal Header Tool</li> <li>I've set the HTTP socket to be non-blocking with ioctlsocket(server-&gt;socket, FIONBIO, &amp;nonblock);</li> <li>The server is set to Cache-Control: no-cache everything by default. This really isn't what we want. Everything but our json should get cached for at least an hour. Modified httpresponse_response to make that happen.</li></ul> <h2 id="imoduleinterface"><a href="#imoduleinterface" class="header-anchor">#</a> IModuleInterface</h2> <ul><li>Inside HTTPAdminPlugin, we have our IModuleInterface class that the Plugin Manager will create</li> <li>Note that unlike the previous example, we use StaticConstructObject to create a UHTTPAdmin object</li> <li>Also of note is that immediately after construction, Init() is called which happens to flag the UHTTPAdmin object to be in the root set and avoid garbage collection. This is very important.</li></ul> <h2 id="httpadmin-header"><a href="#httpadmin-header" class="header-anchor">#</a> HTTPAdmin header</h2> <ul><li>Our UHTTPAdmin class inherits from FTickableGameObject which means the engine will call our ::Tick() every frame</li> <li>We've set our class to Config=HTTPAdmin, this will cause Plugins\HTTPAdmin\Config\DefaultHTTPAdmin.ini to be loaded at runtime and fill out our UPROPERTY(Config) variables</li></ul> <h2 id="httpadmin-source-file"><a href="#httpadmin-source-file" class="header-anchor">#</a> HTTPAdmin source file</h2> <ul><li>Once again, note that ::Init() flags the object as root set so that it won't get garbage collected, that's very important.</li> <li>Due to the way Embedded HTTP works, we had to supply it a static function pointer and pass our classes's this pointer to it. StaticHTTPHandler calls back into our class's this pointer later.</li> <li>::HTTPHandler() does a simple version of HTTP Basic Authentication if the config variable bRequireAuth is set.</li> <li>The HTTP argument &quot;consolecommand&quot; is fetched from either HTTP form POST or GET and then sent to GEngine-&gt;Exec()</li> <li>Any json request is piped into the function PrepareAdminJSON(). PrepareAdminJSON() assembles some relevant server information into a JSON object for easy consumption from admin.html's XMLHTTPRequest.</li> <li>The remainder of ::HTTPHandler() serves data files given certain file extensions</li></ul> <h2 id="easy-ways-to-improve-and-extend-this-example"><a href="#easy-ways-to-improve-and-extend-this-example" class="header-anchor">#</a> Easy ways to improve and extend this example</h2> <ul><li>The HTTP server used is not well suited for world facing applications. It is most likely insecure to buffer overflows and doesn't have threading to handle malicious spam attacks. Updating to a HTTPd implementation that's more robust is recommended. Mongoose may be a good alternative for those doing non-commercial plugins.</li> <li>Hook up kick and ban buttons</li> <li>Make kick and ban do POST requests instead of GET requests</li> <li>Mutator enabling and disabling via web request</li> <li>Map list changing via web request</li> <li>Add some more variables to the JSON output</li></ul> <p>Retrieved from &quot;<a href="https://wiki.unrealengine.com/index.php?title=HTTP_Administration_Plugin_Tutorial&amp;oldid=10612" target="_blank" rel="noopener noreferrer">https://wiki.unrealengine.com/index.php?title=HTTP_Administration_Plugin_Tutorial&amp;oldid=10612<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;</p> <p><a href="/Special:Categories" title="Special:Categories">Categories</a>:</p> <ul><li><a href="/Category:Unreal_Tournament" title="Category:Unreal Tournament">Unreal Tournament</a></li> <li><a href="/Category:UT_Content_Creation" title="Category:UT Content Creation">UT Content Creation</a></li></ul> <p><img src="https://tracking.unrealengine.com/track.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wiki.unrealengine.com/assets/js/app.aaf63946.js" defer></script><script src="/wiki.unrealengine.com/assets/js/2.4f53495e.js" defer></script><script src="/wiki.unrealengine.com/assets/js/555.94521915.js" defer></script>
  </body>
</html>

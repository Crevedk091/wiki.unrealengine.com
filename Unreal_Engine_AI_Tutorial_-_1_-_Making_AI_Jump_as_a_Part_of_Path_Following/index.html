<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wiki.unrealengine.com</title>
    <meta name="description" content="A static site pulled from the internet archive">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css" as="style"><link rel="preload" href="/wiki.unrealengine.com/assets/js/app.aaf63946.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/2.4f53495e.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/1164.0069620c.js" as="script">
    <link rel="stylesheet" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki.unrealengine.com/" class="home-link router-link-active"><!----> <span class="site-name">wiki.unrealengine.com</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Unreal Engine AI Tutorial - 1 - Making AI Jump as a Part of Path Following - Epic Wiki</p> <h1 id="unreal-engine-ai-tutorial-1-making-ai-jump-as-a-part-of-path-following"><a href="#unreal-engine-ai-tutorial-1-making-ai-jump-as-a-part-of-path-following" class="header-anchor">#</a> Unreal Engine AI Tutorial - 1 - Making AI Jump as a Part of Path Following</h1> <p>From Epic Wiki</p> <p>Jump to: <a href="#mw-head">navigation</a>, <a href="#p-search">search</a></p> <p>Authored by: Mieszko Zielinski</p> <p>The very first thing I want to cover in this tutorial series is how to make AI know when to jump when following a navigation path. This tutorial is using C++ approach.</p> <p>There's also an alternative way of achieving jump behavior, and that's by placing SmartNavigationLinks on the level, doable purely in Blueprint, but this will get covered in one of the upcoming tutorials.</p> <p>There are three steps required to achieve this tutorial's goal.</p> <h3 id="_1-implement-a-special-jump-navigation-area"><a href="#_1-implement-a-special-jump-navigation-area" class="header-anchor">#</a> 1. Implement a special &quot;jump&quot; navigation area</h3> <p>One of the ways of annotating navmesh in UE4 is by applying navigation area types to it. There'll be a in-depth tutorial on navigation areas so I'll just say areas can apply a specific set of flags and costs to the navigation mesh.</p> <p>Creating a navigation area is very straightforward. Just create a class deriving from UNavArea, like so:</p> <p><code>UCLASS() class UNavArea_Jump : public UNavArea { GENERATED_UCLASS_BODY() };</code></p> <p>We'll also need to name our &quot;jump&quot; flag so that we can consistently use it throughout our code. Like so:</p> <p><code>UENUM() namespace ENavAreaFlag { // up to 15 values enum Type { Default, Jump, Crouch, // and what not }; }</code></p> <p>Note that we're not using the first bit, since it has a special meaning in our navmesh internals. If first bit in a area is set it means it's walkable, and it's treated as not walkable otherwise. Let's also implement some helper functions for operating on area flags:</p> <p>`namespace FNavAreaHelper
{
FORCEINLINE bool IsSet(uint16 Flags, ENavAreaFlag::Type Bit) { return (Flags &amp; (1 &lt;&lt; Bit)) != 0; }
FORCEINLINE void Set(uint16&amp; Flags, ENavAreaFlag::Type Bit) { Flags |= (1 &lt;&lt; Bit); }</p> <div class="language- extra-class"><pre><code>   FORCEINLINE bool IsNavLink(const FNavPathPoint&amp; PathVert) { return (FNavMeshNodeFlags(PathVert.Flags).PathFlags &amp; RECAST_STRAIGHTPATH_OFFMESH_CONNECTION) != 0; }
   FORCEINLINE bool HasJumpFlag(const FNavPathPoint&amp; PathVert) { return     IsSet(FNavMeshNodeFlags(PathVert.Flags).AreaFlags, ENavAreaFlag::Jump); }
   FORCEINLINE bool HasCrouchFlag(const FNavPathPoint&amp; PathVert) { return IsSet(FNavMeshNodeFlags(PathVert.Flags).AreaFlags, ENavAreaFlag::Crouch); }
</code></pre></div><p>}`</p> <p>Next we need to configure our newly created area class by setting its AreaFlags. We do it in UNavArea_Jump's constructor.</p> <p><code>UNavArea_Jump::UNavArea_Jump(const class FPostConstructInitializeProperties&amp; PCIP)  : Super(PCIP) { FNavAreaHelper::Set(AreaFlags, ENavAreaFlag::Jump); }</code></p> <p>Compile, run, and that's it, jumping area is ready.</p> <h3 id="_2-implement-a-special-path-following-component-for-detecting-jump-links"><a href="#_2-implement-a-special-path-following-component-for-detecting-jump-links" class="header-anchor">#</a> 2. Implement a special path following component for detecting jump links.</h3> <p>This is the most fun part. We need to create a custom path following component to handle jumping. We will reuse this new path following component in future tutorials, by the way.</p> <p>We need our new path following component to derive from <strong>UPathFollowingComponent</strong>. Let's make a class like that and name it <strong>UTutorialPathFollowingComponent</strong>. The function we need to override to be able to detect jumping is <strong>SetMoveSegment</strong> so let's declare that as well. Class declaration should look like this:</p> <p>`UCLASS()
class UTutorialPathFollowingComponent : public UPathFollowingComponent
{
GENERATED_UCLASS_BODY()</p> <p>protected:
/** cached UCharacterMovementComponent <em>/
UPROPERTY(transient)
UCharacterMovementComponent</em> CharacterMoveComp;</p> <p>public:
// used to detect properties of a path's segment a character is about to follow
virtual void SetMoveSegment(int32 SegmentStartIndex) override;</p> <div class="language- extra-class"><pre><code>   // used to cache UCharacterMovementComponent we're using in SetMoveSegment implementation
   virtual void SetMovementComponent(UNavMovementComponent* MoveComp) override;
</code></pre></div><p>};`</p> <p>Implementation of <strong>SetMoveSegment</strong> is the heart of making AI jump in this tutorial. It should look like this:</p> <p>`void UTutorialPathFollowingComponent::SetMoveSegment(int32 SegmentStartIndex)
{
Super::SetMoveSegment(SegmentStartIndex);</p> <div class="language- extra-class"><pre><code>   if (CharacterMoveComp != NULL)
   {
       const FNavPathPoint&amp; SegmentStart = Path-&gt;PathPoints[MoveSegmentStartIndex];

       if (FNavAreaHelper::HasJumpFlag(SegmentStart))
       {
           // jump! well... fly-in-straight-line!
           CharacterMoveComp-&gt;SetMovementMode(MOVE_Flying);
       }
       else
       {
           // regular move
           CharacterMoveComp-&gt;SetMovementMode(MOVE_Walking);
       }
   }
</code></pre></div><p>}`</p> <p>Remember you can find missing code details at tutorial's <a href="https://github.com/MieszkoZ/AITutorialCPP/commit/99450d6cc742f8cfe164c585f8b9c59b41208b03" target="_blank" rel="noopener noreferrer">Github repository<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="_3-make-ai-use-the-new-component"><a href="#_3-make-ai-use-the-new-component" class="header-anchor">#</a> 3. Make AI use the new component</h3> <p>This one's easy, but not obvious. To make AI use <strong>UTutorialPathFollowingComponent</strong> we need to implement a new AI controller class and configure it to use the new component. Create a class deriving from <strong>AAIController</strong> (let's call it <strong>ATutorialAIController</strong>) and implement its constructor like so:</p> <p><code>ATutorialAIController::ATutorialAIController(const FPostConstructInitializeProperties&amp; PCIP)  : Super(PCIP.SetDefaultSubobjectClass&lt;UTutorialPathFollowingComponent&gt;(TEXT(&quot;PathFollowingComponent&quot;))) { }</code></p> <p>This has to be done this way since PathFollowingComponent is the AIController's &quot;sub-object pointer&quot; which means we expect it to be set to an actual object instance all the time.</p> <h3 id="level-setup"><a href="#level-setup" class="header-anchor">#</a> Level setup</h3> <p>One last thing that needs to be done to observe our AI enjoy its newly acquired jumping skill is to have some actual level with jump links.</p> <p>The easiest way to create navigation links on a map is by placing <strong>NavLinkProxy</strong> actors on it (just drag&amp;drop them from the ClassView in the editor). To make these links jump-able you need to modify selected link's properties to use our newly created navigation:</p> <p><a href="/index.php?title=File:AreaClass_Jump.png"><img src="https://d26ilriwvtzlb.cloudfront.net/7/78/AreaClass_Jump.png" alt="AreaClass Jump.png"></a></p> <p>Check out <strong>T01_Jump</strong> in <a href="http://miechu.nazwa.pl/aitutorial_joomla/repo/AITutorial01_Jump.zip" target="_blank" rel="noopener noreferrer">this tutorial's content package<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h3> <p>We've created a way to annotate navmesh with additional information and a way to have AI use that knowledge. Feel free to implement a more sophisticated move in place of my &quot;flying jump&quot; 😉</p> <p>Feel free to suggest new thing I should tackle in this tutorial series. I have a little list to cover, but if your request is on the list then it will get covered even sooner. If it's not I'll handle it once the list is empty. If a feature is widely requested it will make it to the list! 😃)</p> <p>And keep the feedback coming!</p> <p>Cheers!</p> <p>Retrieved from &quot;<a href="https://wiki.unrealengine.com/index.php?title=Unreal_Engine_AI_Tutorial_-_1_-_Making_AI_Jump_as_a_Part_of_Path_Following&amp;oldid=505" target="_blank" rel="noopener noreferrer">https://wiki.unrealengine.com/index.php?title=Unreal_Engine_AI_Tutorial_-_1_-_Making_AI_Jump_as_a_Part_of_Path_Following&amp;oldid=505<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;</p> <p><a href="/index.php?title=Special:Categories" title="Special:Categories">Category</a>:</p> <ul><li><a href="/index.php?title=Category:Tutorials&amp;action=edit&amp;redlink=1" title="Category:Tutorials (page does not exist)">Tutorials</a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wiki.unrealengine.com/assets/js/app.aaf63946.js" defer></script><script src="/wiki.unrealengine.com/assets/js/2.4f53495e.js" defer></script><script src="/wiki.unrealengine.com/assets/js/1164.0069620c.js" defer></script>
  </body>
</html>

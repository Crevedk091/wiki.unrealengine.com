<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wiki.unrealengine.com</title>
    <meta name="description" content="A static site pulled from the internet archive">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css" as="style"><link rel="preload" href="/wiki.unrealengine.com/assets/js/app.aaf63946.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/2.4f53495e.js" as="script"><link rel="preload" href="/wiki.unrealengine.com/assets/js/926.0a6a368c.js" as="script">
    <link rel="stylesheet" href="/wiki.unrealengine.com/assets/css/0.styles.b0e83839.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki.unrealengine.com/" class="home-link router-link-active"><!----> <span class="site-name">wiki.unrealengine.com</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Procedural Mesh Component in C++:Getting Started - Epic Wiki</p> <h1 id="procedural-mesh-component-in-c-getting-started"><a href="#procedural-mesh-component-in-c-getting-started" class="header-anchor">#</a> Procedural Mesh Component in C++:Getting Started</h1> <p>From Epic Wiki</p> <p>Jump to: <a href="#mw-head">navigation</a>, <a href="#p-search">search</a></p> <p><a href="/index.php?title=Template:Rating&amp;action=edit&amp;redlink=1" title="Template:Rating (page does not exist)">Template:Rating</a></p> <p>The following is a brief guide to getting the experimental plugin &quot;ProceduralMeshComponent&quot; for procedural generation of meshes purely in C++. There doesn't seem to be any information anywhere, so I decided to put what I've done here in hopes others will extend it.</p> <p><a href="/index.php?title=File:UProceduralMeshComponentGeneratedTriangle.png"><img src="https://d26ilriwvtzlb.cloudfront.net/b/bc/UProceduralMeshComponentGeneratedTriangle.png" alt="UProceduralMeshComponentGeneratedTriangle.png"></a></p> <p>I create a simple triangle using the UProceduralMeshComponent API, from there extending it should be easy. Once the class is compiled you can just drag it into your scene.</p> <p>To use this component, include the paths in the build.cs file of your project:</p> <p>MyProject.Build.cs:</p> <p><syntaxhighlight lang="cpp"> PublicDependencyModuleNames.AddRange(new string[] { &quot;Core&quot;, &quot;CoreUObject&quot;, &quot;Engine&quot;, &quot;InputCore&quot;, &quot;ProceduralMeshComponent&quot; }); </syntaxhighlight></p> <p>and in your .uproject file (MyProject.uproject) in case you work on a project:</p> <syntaxhighlight lang="cpp"><p>&quot;AdditionalDependencies&quot;: [..., ..., &quot;ProceduralMeshComponent&quot;]</p></syntaxhighlight> <p>After 4.17, plugins can now depend on other plugins, so in case you are working on a <strong>plugin</strong> instead of a project, you will have to add this to your .uplugin file:</p> <syntaxhighlight lang="cpp"><p>&quot;Modules&quot;: [
{
....
}
],
&quot;Plugins&quot;: [                       // &lt;--
{                                // &lt;--
&quot;Name&quot;: &quot;ProceduralMeshComponent&quot;,    // &lt;--
&quot;Enabled&quot;: true                // &lt;--
}                                // &lt;--
]</p></syntaxhighlight> <p>To fix errors with Visual Studio IntelliSense you need to right-click MyProject.uproject and re-generate Visual Studio project files. In Visual Studio 2017, open &quot;Solution Explorer&quot; and open the &quot;Game&quot; folder, right-click on the first line, which should be the root of your solution, select: &quot;Rescan Solution&quot;.</p> <p>I've created an Actor class.</p> <p>Add the header to your MyActor.h file above the &quot;MyActor.generated.h&quot; include which has to be the last include.</p> <syntaxhighlight lang="cpp"><ol><li>include &quot;ProceduralMeshComponent.h&quot;</li> <li>include &quot;MyActor.generated.h&quot;</li></ol></syntaxhighlight> <p>In the header file, the following is added to support assigning a material.</p> <syntaxhighlight lang="cpp"><p>private: UPROPERTY(VisibleAnywhere) UProceduralMeshComponent * mesh; </p></syntaxhighlight><p></p> <p>In my cpp file I have added the following to the constructor:</p> <p>MyActor.cpp <syntaxhighlight lang="cpp"> // Creating a standard root object. AMyActor::AMyActor() { mesh = CreateDefaultSubobject<UProceduralMeshComponent>(TEXT(&quot;GeneratedMesh&quot;)); RootComponent = mesh;</UProceduralMeshComponent></syntaxhighlight></p> <div class="language- extra-class"><pre><code>   // New in UE 4.17, multi-threaded PhysX cooking.
   mesh-&gt;bUseAsyncCooking = true;
</code></pre></div><p>}</p> <p>// This is called when actor is spawned (at runtime or when you drop it into the world in editor) void AMyActor::PostActorCreated() { Super::PostActorCreated(); CreateTriangle(); }</p> <p>// This is called when actor is already in level and map is opened void AMyActor::PostLoad() { Super::PostLoad(); CreateTriangle(); }</p> <p>void AMyActor::CreateTriangle() { TArray<FVector> vertices; vertices.Add(FVector(0, 0, 0)); vertices.Add(FVector(0, 100, 0)); vertices.Add(FVector(0, 0, 100));</FVector></p> <p>TArray<int32> Triangles; Triangles.Add(0); Triangles.Add(1); Triangles.Add(2);</int32></p> <p>TArray<FVector> normals; normals.Add(FVector(1, 0, 0)); normals.Add(FVector(1, 0, 0)); normals.Add(FVector(1, 0, 0));</FVector></p> <p>TArray<FVector2D> UV0; UV0.Add(FVector2D(0, 0)); UV0.Add(FVector2D(10, 0)); UV0.Add(FVector2D(0, 10));</FVector2D></p> <p>TArray<FProcMeshTangent> tangents; tangents.Add(FProcMeshTangent(0, 1, 0)); tangents.Add(FProcMeshTangent(0, 1, 0)); tangents.Add(FProcMeshTangent(0, 1, 0));</FProcMeshTangent></p> <p>TArray<FLinearColor> vertexColors; vertexColors.Add(FLinearColor(0.75, 0.75, 0.75, 1.0)); vertexColors.Add(FLinearColor(0.75, 0.75, 0.75, 1.0)); vertexColors.Add(FLinearColor(0.75, 0.75, 0.75, 1.0));</FLinearColor></p> <p>mesh-&gt;CreateMeshSection_LinearColor(0, vertices, Triangles, normals, UV0, vertexColors, tangents, true);</p> <div class="language- extra-class"><pre><code>   // Enable collision data
</code></pre></div><p>mesh-&gt;ContainsPhysicsTriMeshData(true); } </p> <p>The documentation for CreateMeshSection and CreateMeshSection_LinearColor functions is this:</p> <p><syntaxhighlight lang="cpp"> /** * Create/replace a section for this procedural mesh component. * @param SectionIndex Index of the section to create or replace. * @param Vertices Vertex buffer of all vertex positions to use for this mesh section. * @param Triangles Index buffer indicating which vertices make up each triangle. Length must be a multiple of 3. * @param Normals Optional array of normal vectors for each vertex. If supplied, must be same length as Vertices array. * @param UV0 Optional array of texture co-ordinates for each vertex. If supplied, must be same length as Vertices array. * @param VertexColors Optional array of colors for each vertex. If supplied, must be same length as Vertices array. * @param Tangents Optional array of tangent vector for each vertex. If supplied, must be same length as Vertices array. * @param bCreateCollision Indicates whether collision should be created for this section. This adds significant cost. */</syntaxhighlight></p> <p>// <strong>Don't use this function</strong>. It is deprecated. Use LinearColor version. void CreateMeshSection(int32 SectionIndex, const TArray<FVector>&amp; Vertices, const TArray<int32>&amp; Triangles, const TArray<FVector>&amp; Normals, const TArray<FVector2D>&amp; UV0, const TArray<FColor>&amp; VertexColors, const TArray<FProcMeshTangent>&amp; Tangents, bool bCreateCollision);</FProcMeshTangent></FColor></FVector2D></FVector></int32></FVector></p> <p>// In this one you can send FLinearColor instead of FColor for the Vertex Colors. void CreateMeshSection_LinearColor(int32 SectionIndex, const TArray<FVector>&amp; Vertices, const TArray<int32>&amp; Triangles, const TArray<FVector>&amp; Normals, const TArray<FVector2D>&amp; UV0, const TArray<FLinearColor>&amp; VertexColors, const TArray<FProcMeshTangent>&amp; Tangents, bool bCreateCollision)</FProcMeshTangent></FLinearColor></FVector2D></FVector></int32></FVector></p> <p>// Updates a section of this procedural mesh component. This is faster than CreateMeshSection, but does not let you change topology. Collision info is also updated. void UpdateMeshSection_LinearColor(int32 SectionIndex, const TArray<FVector>&amp; Vertices, const TArray<FVector>&amp; Normals, const TArray<FVector2D>&amp; UV0, const TArray<FLinearColor>&amp; VertexColors, const TArray<FProcMeshTangent>&amp; Tangents);</FProcMeshTangent></FLinearColor></FVector2D></FVector></FVector></p> <p>If you have a <YourGameName>GameModeBase.cpp, make sure to add a reference to the header of the class where you added the above code, that way you will see it in your Editor in &quot;C++ Classes&quot; Content Browser and will be able to drag it to your scene.</YourGameName></p> <p>Retrieved from &quot;<a href="https://wiki.unrealengine.com/index.php?title=Procedural_Mesh_Component_in_C%2B%2B:Getting_Started&amp;oldid=119" target="_blank" rel="noopener noreferrer">https://wiki.unrealengine.com/index.php?title=Procedural_Mesh_Component_in_C%2B%2B:Getting_Started&amp;oldid=119<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;</p> <p><a href="/index.php?title=Special:Categories" title="Special:Categories">Categories</a>:</p> <ul><li><a href="/index.php?title=Category:Tutorials&amp;action=edit&amp;redlink=1" title="Category:Tutorials (page does not exist)">Tutorials</a></li> <li><a href="/index.php?title=Category:Code" title="Category:Code">Code</a></li> <li><a href="/index.php?title=Category:Community_Created_Content" title="Category:Community Created Content">Community Created Content</a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wiki.unrealengine.com/assets/js/app.aaf63946.js" defer></script><script src="/wiki.unrealengine.com/assets/js/2.4f53495e.js" defer></script><script src="/wiki.unrealengine.com/assets/js/926.0a6a368c.js" defer></script>
  </body>
</html>

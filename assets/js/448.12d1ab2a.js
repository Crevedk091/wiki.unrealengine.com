(window.webpackJsonp=window.webpackJsonp||[]).push([[448],{796:function(e,t,a){"use strict";a.r(t);var n=a(28),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("Delegates In UE4, Raw Cpp and BP Exposed - Epic Wiki")]),e._v(" "),a("h1",{attrs:{id:"delegates-in-ue4-raw-cpp-and-bp-exposed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#delegates-in-ue4-raw-cpp-and-bp-exposed"}},[e._v("#")]),e._v(" Delegates In UE4, Raw Cpp and BP Exposed")]),e._v(" "),a("p",[e._v("From Epic Wiki")]),e._v(" "),a("p",[e._v("Jump to: "),a("a",{attrs:{href:"#mw-head"}},[e._v("navigation")]),e._v(", "),a("a",{attrs:{href:"#p-search"}},[e._v("search")])]),e._v(" "),a("h2",{attrs:{id:"contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contents"}},[e._v("#")]),e._v(" Contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#Overview"}},[e._v("1 Overview")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Steps"}},[e._v("2 Steps")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#Signature"}},[e._v("2.1 Signature")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Calling_the_Delegate"}},[e._v("2.2 Calling the Delegate")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#.h"}},[e._v("2.2.1 .h")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#.cpp"}},[e._v("2.2.2 .cpp")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Responding_to_the_Delegate"}},[e._v("2.3 Responding to the Delegate")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#UFUNCTION.28.29_.21"}},[e._v("3 UFUNCTION()  !")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Binding_To_The_Delegate"}},[e._v("4 Binding To The Delegate")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#Dynamic_Delegates"}},[e._v("4.1 Dynamic Delegates")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Multicast_Delegates"}},[e._v("4.2 Multicast Delegates")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Non_Multicast"}},[e._v("4.3 Non Multicast")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Raw_C.2B.2B_Class_Instances"}},[e._v("5 Raw C++ Class Instances")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Slate_Class_Instances"}},[e._v("6 Slate Class Instances")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Binding_is_Per-Instance"}},[e._v("7 Binding is Per-Instance")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#BP-Friendly_Delegates"}},[e._v("8 BP-Friendly Delegates")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Level_Blueprint_Friendly_Delegates"}},[e._v("9 Level Blueprint Friendly Delegates")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Video_Example"}},[e._v("10 Video Example")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Further_Reading"}},[e._v("11 Further Reading")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#DYNAMIC_MULTICAST_And_Other_Types"}},[e._v("12 DYNAMIC_MULTICAST And Other Types")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Conclusion"}},[e._v("13 Conclusion")])])]),e._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),a("p",[e._v("Original Author: "),a("a",{attrs:{href:"/index.php?title=User:Rama",title:"User:Rama"}},[e._v("Rama")]),e._v(" ("),a("a",{attrs:{href:"/index.php?title=User_talk:Rama",title:"User talk:Rama"}},[e._v("talk")]),e._v(")")]),e._v(" "),a("p",[e._v("In this wiki I share with you the core code that you need to implement for a variety of delegates in UE4!")]),e._v(" "),a("p",[e._v("A delegate is basically an event that you can define and call and respond to.")]),e._v(" "),a("p",[e._v("Every time the event is fired off, anyone who is listening for this event will receive it and be able to take appropriate action.")]),e._v(" "),a("p",[e._v("In the case of "),a("strong",[e._v("multicast")]),e._v(" delegates, any number of entities within your code base can respond to the same event and receive the inputs and use them.")]),e._v(" "),a("p",[e._v("In the case of "),a("strong",[e._v("dynamic")]),e._v(" delegates, the delegate can be saved/loaded within a Blueprint graph (they're called Events/Event Dispatcher in BP).")]),e._v(" "),a("p",[e._v("For my example I will be using exclusively DYNAMIC_MULTICAST which is the type that is most useful in Blueprints 😃")]),e._v(" "),a("h2",{attrs:{id:"steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#steps"}},[e._v("#")]),e._v(" Steps")]),e._v(" "),a("h4",{attrs:{id:"signature"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signature"}},[e._v("#")]),e._v(" Signature")]),e._v(" "),a("p",[e._v("You create the signature of the delegate, which declares what inputs any receiving functions should specify.")]),e._v(" "),a("p",[e._v("//RamaMeleeWeapon class .h")]),e._v(" "),a("p",[e._v("DECLARE_DYNAMIC_MULTICAST_DELEGATE_SixParams( FRamaMeleeHitSignature, class AActor*, HitActor, class UPrimitiveComponent*, HitComponent, const FVector&, ImpactPoint, const FVector&, ImpactNormal, FName, HitBoneName, const struct FHitResult&, HitResult );")]),e._v(" "),a("p",[e._v("Notice the macro declares that I will be adding 6 parameters, there are similar macros for other quantities of parameters 😃")]),e._v(" "),a("p",[e._v("DECLARE_DYNAMIC_MULTICAST_DELEGATE_SixParams")]),e._v(" "),a("h4",{attrs:{id:"calling-the-delegate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calling-the-delegate"}},[e._v("#")]),e._v(" Calling the Delegate")]),e._v(" "),a("p",[e._v("You call the delegate within the class structure where it was defined, making sure to only execute it if it is currently bound, meaning at least 1 entity is listening for this delegate / event.")]),e._v(" "),a("h5",{attrs:{id:"h"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#h"}},[e._v("#")]),e._v(" .h")]),e._v(" "),a("p",[e._v("//.h\n//RamaMeleeWeapon class .h")]),e._v(" "),a("p",[e._v("//This should be in the class which calls the delegate, and where the signature was defined\n//This is an instance of the signature that was defined above!\nFRamaMeleeHitSignature RamaMeleeWeapon_OnHit;")]),e._v(" "),a("h5",{attrs:{id:"cpp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpp"}},[e._v("#")]),e._v(" .cpp")]),e._v(" "),a("p",[e._v("//.cpp\n//Only the code that is supposed to initiate the event calls Broadcast()\nif(RamaMeleeWeapon_OnHit.IsBound()) //<~~~~\n{\nRamaMeleeWeapon_OnHit.Broadcast(Hit.GetActor(), Hit.GetComponent(), Hit.ImpactPoint, Hit.ImpactNormal, Hit.BoneName, Hit);\n}")]),e._v(" "),a("p",[e._v("Comment from "),a("a",{attrs:{href:"/index.php?title=User:Darkgaze&action=edit&redlink=1",title:"User:Darkgaze (page does not exist)"}},[e._v("Darkgaze")]),e._v(": As the official "),a("a",{attrs:{href:"https://docs.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Delegates/Multicast/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Multicast docs"),a("OutboundLink")],1),e._v(" say:")]),e._v(" "),a("p",[a("em",[e._v("(...)It is always safe to call Broadcast() on a multi-cast delegate, even if nothing is bound. The only time you need to be careful is if you are using a delegate to initialize output variables, which is generally very bad to do.(...)")])]),e._v(" "),a("p",[e._v("So calling InBound() is not necessary. Only in Single-cast delegates.")]),e._v(" "),a("h4",{attrs:{id:"responding-to-the-delegate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#responding-to-the-delegate"}},[e._v("#")]),e._v(" Responding to the Delegate")]),e._v(" "),a("p",[e._v("Anywhere you want, you can declare functions which receive the parameters by type and name specified in the delegate signature.")]),e._v(" "),a("p",[e._v("//Any class can add a function that uses the delegate signature and responds to the Broadcast() event\nUFUNCTION()\nvoid RespondToMeleeDamageTaken(AActor* HitActor, UPrimitiveComponent* HitComponent, const FVector& ImpactPoint, const FVector& ImpactNormal, FName HitBoneName, const FHitResult& HitResult)")]),e._v(" "),a("p",[e._v("See below to learn how to bind the delegate instance to this function or any number of functions that are present in class instances anywhere in your code base!")]),e._v(" "),a("h2",{attrs:{id:"ufunction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ufunction"}},[e._v("#")]),e._v(" UFUNCTION()  !")]),e._v(" "),a("p",[e._v("Please note that functions that are responding to delegate broadcasts should be UFUNCTION()!")]),e._v(" "),a("p",[e._v("If your delegate Broadcast stalls the game for a bit and then doesnt work, it's because you did not make one of your receiving functions a UFUNCTION()")]),e._v(" "),a("p",[e._v("❤️ Rama")]),e._v(" "),a("h2",{attrs:{id:"binding-to-the-delegate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#binding-to-the-delegate"}},[e._v("#")]),e._v(" Binding To The Delegate")]),e._v(" "),a("h3",{attrs:{id:"dynamic-delegates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-delegates"}},[e._v("#")]),e._v(" Dynamic Delegates")]),e._v(" "),a("p",[e._v("RamaMeleeWeaponComp->RamaMeleeWeapon_OnHit.AddDynamic(this, &USomeClass::RespondToMeleeDamageTaken); //see above in wiki")]),e._v(" "),a("h3",{attrs:{id:"multicast-delegates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#multicast-delegates"}},[e._v("#")]),e._v(" Multicast Delegates")]),e._v(" "),a("p",[e._v("Binding to non-dynamic requires this syntax:")]),e._v(" "),a("p",[e._v("RamaMeleeWeaponComp->RamaMeleeWeapon_OnHit.AddUObject(this, &USomeClass::RespondToMeleeDamageTaken); //see above in wiki")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture/Delegates/Multicast",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture/Delegates/Multicast"),a("OutboundLink")],1)]),e._v(" "),a("h3",{attrs:{id:"non-multicast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#non-multicast"}},[e._v("#")]),e._v(" Non Multicast")]),e._v(" "),a("p",[e._v("Binding a UObject to a non-dynamic, non-multicast delegate requires you to use the following syntax.")]),e._v(" "),a("p",[e._v("//in some class cpp file")]),e._v(" "),a("p",[e._v("RamaMeleeWeaponComp->RamaMeleeWeapon_OnHit.BindUObject(this, &USomeClass::RespondToMeleeDamageTaken); //see above in wiki")]),e._v(" "),a("p",[e._v("You need to access the delegate where it is stored, in my case this is the RamaMeleeWeaponComponent")]),e._v(" "),a("p",[e._v("The idea is you are telling the delegate instance that it is getting a new binding, to this SomeClass insance, which is why you include the "),a("em",[e._v("this")]),e._v(" pointer.")]),e._v(" "),a("p",[e._v("So this code appears where you want to add the binding to the event/delegate, but it must refer to the one signature instance present in the original class instance.")]),e._v(" "),a("p",[e._v("So basically this delegate binding is "),a("strong",[e._v("an agreement between two instances")]),e._v(", where one instance is of the class that declares and implements the delegate, and the other instance is any ole' class that has declared the function signature to match the delegate signature.")]),e._v(" "),a("p",[e._v("There's nothing abstract here, everything is instances, so you must bind your object instance to the delegate signature instance that is part of the instance of the class that is going to fire off the broadcasting.")]),e._v(" "),a("p",[e._v("This is why I have a pointer to RamaMeleeWeaponComp->RamaMeleeWeapon_OnHit, and I am "),a("strong",[e._v("also")]),e._v(" including the "),a("em",[e._v("this")]),e._v(" pointer so that the signature knows about the calling object instance.")]),e._v(" "),a("p",[e._v("The reason it is a "),a("em",[e._v("this")]),e._v(" pointer is because the code above is run in the object that wants to bind to the delegate, so "),a("em",[e._v("this")]),e._v(" is a self-referencing pointer to the UObject we are binding to the delegate.")]),e._v(" "),a("h2",{attrs:{id:"raw-c-class-instances"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#raw-c-class-instances"}},[e._v("#")]),e._v(" Raw C++ Class Instances")]),e._v(" "),a("p",[e._v("Raw delegates are used with non UObject classes, like plugin modules.")]),e._v(" "),a("p",[e._v("RamaMeleeWeaponComp->RamaMeleeWeapon_OnHit.BindRaw(this, &FSomeRawCPPClass::RespondToMeleeDamageTaken);")]),e._v(" "),a("h2",{attrs:{id:"slate-class-instances"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#slate-class-instances"}},[e._v("#")]),e._v(" Slate Class Instances")]),e._v(" "),a("p",[e._v("Slate delegates use this syntax:")]),e._v(" "),a("p",[e._v("RamaMeleeWeaponComp->RamaMeleeWeapon_OnHit.CreateSP(this, &SSomeSlateClass::RespondToMeleeDamageTaken);")]),e._v(" "),a("h2",{attrs:{id:"binding-is-per-instance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#binding-is-per-instance"}},[e._v("#")]),e._v(" Binding is Per-Instance")]),e._v(" "),a("p",[e._v("Please note that when you bind to the delegate this is a per-instance process! That is why you need to include the "),a("em",[e._v("this")]),e._v(" pointer, because whichever instance you are calling the code in, it is that particular instance whose function will get called when the delegate is broadcasted.")]),e._v(" "),a("p",[e._v("This means you can choose to have only certain instances of a uobject respond to a delegate, or choose to bind or unbind at any time!")]),e._v(" "),a("h2",{attrs:{id:"bp-friendly-delegates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bp-friendly-delegates"}},[e._v("#")]),e._v(" BP-Friendly Delegates")]),e._v(" "),a("p",[e._v("A BP friendly delegate requires this additional .h code to expose the delegate to Blueprints.")]),e._v(" "),a("p",[e._v("//RamaMeleeWeapon.h")]),e._v(" "),a("p",[e._v('UPROPERTY(BlueprintAssignable, Category="Rama Melee Weapon")\nFRamaMeleeHitSignature RamaMeleeWeapon_OnHit;')]),e._v(" "),a("p",[e._v("BP-friendly Delegates should be DYNAMIC_MULTICAST so they can be serialized (saved/loaded) with the BP graph.")]),e._v(" "),a("h2",{attrs:{id:"level-blueprint-friendly-delegates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#level-blueprint-friendly-delegates"}},[e._v("#")]),e._v(" Level Blueprint Friendly Delegates")]),e._v(" "),a("p",[e._v("When you've made BP-friendly delegates on objects that you can place in the level, you can simply right click on the object instance in your level -> Add Event and see your new delegate! So nice!")]),e._v(" "),a("p",[e._v("This is an additional benefit of using DYNAMIC_MULTICAST delegates! Multi-cast implies binding multiple of various object instances to the delegate and then firing off the event to everyone from a single .Broadcast, which can include your Level Blueprint as a recipient/listener!")]),e._v(" "),a("h2",{attrs:{id:"video-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#video-example"}},[e._v("#")]),e._v(" Video Example")]),e._v(" "),a("p",[e._v("Here is a video on how a C++ delegate created in an actor component in C++ looks and is called in Blueprints!")]),e._v(" "),a("p",[e._v("The code in this wiki and this video are from my "),a("a",{attrs:{href:"http://ue4code.com/melee_weapon_system_plugin_per_bone_collision_accuracy",target:"_blank",rel:"noopener noreferrer"}},[e._v("Melee Weapon Plugin"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("youtube",[a("a",{attrs:{href:"http://www.youtube.com/watch?v=aufEB4TCf30&t=5m24s",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://www.youtube.com/watch?v=aufEB4TCf30&t=5m24s"),a("OutboundLink")],1)])],1),e._v(" "),a("p",[a("a",{attrs:{href:"http://www.youtube.com/watch?v=aufEB4TCf30&t=5m24s",target:"_blank",rel:"noopener noreferrer"}},[e._v("Skip to 5:24"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"further-reading"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#further-reading"}},[e._v("#")]),e._v(" Further Reading")]),e._v(" "),a("p",[e._v("Epic Documentation: "),a("a",{attrs:{href:"https://docs.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Delegates/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Delegates/"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"dynamic-multicast-and-other-types"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-multicast-and-other-types"}},[e._v("#")]),e._v(" DYNAMIC_MULTICAST And Other Types")]),e._v(" "),a("p",[e._v("There are other delegate types besides DYNAMIC_MULTICAST that are not quite as versatile when it comes to Blueprints.")]),e._v(" "),a("p",[e._v("Check out the source code of Delegate.h")]),e._v(" "),a("p",[e._v("Runtime/Core/Public/Delegates/Delegate.h")]),e._v(" "),a("p",[e._v("For a detailed explanation!")]),e._v(" "),a("p",[e._v("Sample from this file:")]),e._v(" "),a("p",[e._v('**\n*  C++ DELEGATES\n*  -----------------------------------------------------------------------------------------------\n*\n*\tThis system allows you to call member functions on C++ objects in a generic, yet type-safe way.\n*  Using delegates, you can dynamically bind to a member function of an arbitrary object,\n*\tthen call functions on the object, even if the caller doesn\'t know the object\'s type.\n*\n*\tThe system predefines various combinations of generic function signatures with which you can\n*\tdeclare a delegate type from, filling in the type names for return value and parameters with\n*\twhichever types you need.\n*\n*\tBoth single-cast and multi-cast delegates are supported, as well as "dynamic" delegates which\n*\tcan be safely serialized to disk.  Additionally, delegates may define "payload" data which\n*\twill stored and passed directly to bound functions.')]),e._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),a("p",[e._v("Enjoy using delegates in UE4 so that any part of your code base can respond to an event triggered by one section of your code!")]),e._v(" "),a("p",[e._v("Also enjoy exposing delegates via C++ for the rest of your team to use in Blueprints!")]),e._v(" "),a("p",[e._v("Enjoooy!")]),e._v(" "),a("p",[e._v("♥")]),e._v(" "),a("p",[e._v("Rama")]),e._v(" "),a("p",[e._v('Retrieved from "'),a("a",{attrs:{href:"https://wiki.unrealengine.com/index.php?title=Delegates_In_UE4,_Raw_Cpp_and_BP_Exposed&oldid=181",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://wiki.unrealengine.com/index.php?title=Delegates_In_UE4,_Raw_Cpp_and_BP_Exposed&oldid=181"),a("OutboundLink")],1),e._v('"')]),e._v(" "),a("p",[a("a",{attrs:{href:"/index.php?title=Special:Categories",title:"Special:Categories"}},[e._v("Categories")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"/index.php?title=Category:Tutorials&action=edit&redlink=1",title:"Category:Tutorials (page does not exist)"}},[e._v("Tutorials")])]),e._v(" "),a("li",[a("a",{attrs:{href:"/index.php?title=Category:Code",title:"Category:Code"}},[e._v("Code")])]),e._v(" "),a("li",[a("a",{attrs:{href:"/index.php?title=Category:Community_Created_Content",title:"Category:Community Created Content"}},[e._v("Community Created Content")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);
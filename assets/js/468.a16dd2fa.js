(window.webpackJsonp=window.webpackJsonp||[]).push([[468],{862:function(e,t,n){"use strict";n.r(t);var a=n(28),i=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[e._v("Dynamic Textures - Epic Wiki")]),e._v(" "),n("h1",{attrs:{id:"dynamic-textures"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-textures"}},[e._v("#")]),e._v(" Dynamic Textures")]),e._v(" "),n("p",[e._v("Sometimes it's necessary to create a texture at runtime and update its contents. Depending on your particular needs there are a couple different methods:")]),e._v(" "),n("ul",[n("li",[e._v("If you need to create a dynamic UTexture2D at runtime and update it efficiently every frame, use UTexture2D::CreateTransient() and copy/paste the following function:")])]),e._v(" "),n("p",[e._v("NOTE: Currently UE4 doesn't support updating subregions of a texture so you have to update the entire thing every frame or you will end up with garbage in places. In the DX11 runtime the texture creation is done with D3D11_USAGE_DEFAULT not D3D11_USAGE_DYNAMIC.")]),e._v(" "),n("p",[e._v("DynamicTexture = UTexture2D::CreateTransient(SizeX, SizeY);\n \n// Allocate the texture HRI\nDynamicTexture->UpdateResource();\n \n// Use this function to update the texture rects you want to change:\n// NOTE: There is a method called UpdateTextureRegions in UTexture2D but it is compiled WITH_EDITOR and is not marked as ENGINE_API so it cannot be linked\n// from plugins.\n \nvoid UpdateTextureRegions(UTexture2D* Texture, int32 MipIndex, uint32 NumRegions, FUpdateTextureRegion2D* Regions, uint32 SrcPitch, uint32 SrcBpp, uint8* SrcData, bool bFreeData)\n{\nif (Texture->Resource)\n{\nstruct FUpdateTextureRegionsData\n{\nFTexture2DResource* Texture2DResource;\nint32 MipIndex;\nuint32 NumRegions;\nFUpdateTextureRegion2D* Regions;\nuint32 SrcPitch;\nuint32 SrcBpp;\nuint8* SrcData;\n};\n \nFUpdateTextureRegionsData* RegionData = new FUpdateTextureRegionsData;\n \nRegionData->Texture2DResource = (FTexture2DResource*)Texture->Resource;\nRegionData->MipIndex = MipIndex;\nRegionData->NumRegions = NumRegions;\nRegionData->Regions = Regions;\nRegionData->SrcPitch = SrcPitch;\nRegionData->SrcBpp = SrcBpp;\nRegionData->SrcData = SrcData;\n \nENQUEUE_UNIQUE_RENDER_COMMAND_TWOPARAMETER(\nUpdateTextureRegionsData,\nFUpdateTextureRegionsData*, RegionData, RegionData,\nbool, bFreeData, bFreeData,\n{\nfor (uint32 RegionIndex = 0; RegionIndex < RegionData->NumRegions; ++RegionIndex)\n{\nint32 CurrentFirstMip = RegionData->Texture2DResource->GetCurrentFirstMip();\nif (RegionData->MipIndex >= CurrentFirstMip)\n{\nRHIUpdateTexture2D(\nRegionData->Texture2DResource->GetTexture2DRHI(),\nRegionData->MipIndex - CurrentFirstMip,\nRegionData->Regions[RegionIndex],\nRegionData->SrcPitch,\nRegionData->SrcData\n+ RegionData->Regions[RegionIndex].SrcY * RegionData->SrcPitch\n+ RegionData->Regions[RegionIndex].SrcX * RegionData->SrcBpp\n);\n}\n}\nif (bFreeData)\n{\nFMemory::Free(RegionData->Regions);\nFMemory::Free(RegionData->SrcData);\n}\ndelete RegionData;\n});\n}\n}")]),e._v(" "),n("ul",[n("li",[e._v("If you need to create a dynamic texture and update it a single time you can use this method. Note: After every call to Lock/Unlock you must call UpdateResource(). This deletes the HRI texture and recreates it so it won't be fast but if done infrequently it is simpler to use.")])]),e._v(" "),n("p",[e._v("Texture = UTexture2D::CreateTransient(SizeX, SizeY);\nFTexture2DMipMap& Mip = [Texture]->PlatformData->Mips[Level];\nvoid* Data = Mip.BulkData.Lock( LOCK_READ_WRITE );\nFMemory::Memcpy( Data, NewData, DataSize );\nMip.BulkData.Unlock( );\nTexture->UpdateResource();")]),e._v(" "),n("ul",[n("li",[e._v("If you are using Slate, or a Slate viewport to render you can use a FSlateTexture2DRHIRef which can be created from the slate function:")])]),e._v(" "),n("p",[e._v("FSlateTexture2DRHIRef Texture = MakeShareable(new FSlateTexture2DRHIRef(Width, Height, PF_B8G8R8A8, NULL, TexCreate_Dynamic, bCreateEmptyTexture));")]),e._v(" "),n("p",[e._v('Retrieved from "'),n("a",{attrs:{href:"https://wiki.unrealengine.com/index.php?title=Dynamic_Textures&oldid=4120",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://wiki.unrealengine.com/index.php?title=Dynamic_Textures&oldid=4120"),n("OutboundLink")],1),e._v('"')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://tracking.unrealengine.com/track.png",alt:""}})])])}),[],!1,null,null,null);t.default=i.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{918:function(e,t,a){"use strict";a.r(t);var o=a(28),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("AI Navigation in C++, Customize Path Following Every Tick - Epic Wiki")]),e._v(" "),a("h1",{attrs:{id:"ai-navigation-in-c-customize-path-following-every-tick"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ai-navigation-in-c-customize-path-following-every-tick"}},[e._v("#")]),e._v(" AI Navigation in C++, Customize Path Following Every Tick")]),e._v(" "),a("h2",{attrs:{id:"contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contents"}},[e._v("#")]),e._v(" Contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#Overview"}},[e._v("1 Overview")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Rama_C.2B.2B_AI_Jumping_Video"}},[e._v("2 Rama C++ AI Jumping Video")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Rama_Video_.7E_Training_PhysX_Simulating_Balls_to_Navigate_Narrow_Ledges.21"}},[e._v("3 Rama Video ~ Training PhysX Simulating Balls to Navigate Narrow Ledges!")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Steps"}},[e._v("4 Steps")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#Have_your_own_Custom_ai_controller_.28extends_AAIController.29"}},[e._v("4.1 Have your own Custom ai controller (extends AAIController)")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Tell_ai_controller_to_use_custom_path_following_component.2C_which_extends_the_base_UE4_class"}},[e._v("4.2 Tell ai controller to use custom path following component, which extends the base UE4 class")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Make_sure_your_build.cs_is_including_AIModule_as_part_of_your_dependencies"}},[e._v("4.3 Make sure your build.cs is including AIModule as part of your dependencies")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Override_these_functions_in_your_custom_PathFollowingComponent.21"}},[e._v("4.4 Override these functions in your custom PathFollowingComponent!")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Video_Result"}},[e._v("5 Video Result")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#More_of_Ny_Customized_C.2B.2B_AI_Pathing_Videos"}},[e._v("6 More of Ny Customized C++ AI Pathing Videos")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#How_to_Get_All_UE4_Navigation_Polys"}},[e._v("7 How to Get All UE4 Navigation Polys")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Conclusion"}},[e._v("8 Conclusion")])])]),e._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),a("p",[a("a",{attrs:{href:"/File:RamaAIJump.gif"}},[a("img",{attrs:{src:"https://d26ilriwvtzlb.cloudfront.net/7/7a/RamaAIJump.gif",alt:"RamaAIJump.gif"}})])]),e._v(" "),a("p",[a("em",[e._v("Original Author:")]),e._v(" "),a("a",{attrs:{href:"/User:Rama",title:"User:Rama"}},[e._v("Rama")]),e._v(" ("),a("a",{attrs:{href:"/User_talk:Rama",title:"User talk:Rama"}},[e._v("talk")]),e._v(")")]),e._v(" "),a("p",[e._v("Dear Community, As gif above shows there is a way to modify standard UE4 pathing via C++ to introduce customized path following behavior without rewriting the whole system!")]),e._v(" "),a("p",[e._v("In gif above I am telling the unit how to jump from one nav mesh piece to another using only C++ (nothing was placed in the editor other than basic nav mesh, and I can add new level geometry any time)")]),e._v(" "),a("p",[e._v("I am also drawing each UE4 Nav Area that the unit is passing through, and I use Nav Mesh Traces + the area info to identify how the unit should jump, and at what angle, to path over terrain that requires jumping.")]),e._v(" "),a("p",[e._v("The point of this wiki is that my method involves only C++ code and a custom Path Following Component.")]),e._v(" "),a("p",[e._v("I am adding to the stock UE4 code, keeping its benefits, while introducing my own custom path following mechanics.")]),e._v(" "),a("h2",{attrs:{id:"rama-c-ai-jumping-video"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rama-c-ai-jumping-video"}},[e._v("#")]),e._v(" Rama C++ AI Jumping Video")]),e._v(" "),a("p",[e._v("I used the code structure I am describing in this wiki to train my AI to do jump pathing calculations using just UE4 C++!")]),e._v(" "),a("p",[e._v("More Rama AI Jumping Videos")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://forums.unrealengine.com/showthread.php?25410-Rama-s-Multi-Threaded-Dynamic-Pathing-System-Full-Physics-Support&p=251216&viewfull=1#post251216",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://forums.unrealengine.com/showthread.php?25410-Rama-s-Multi-Threaded-Dynamic-Pathing-System-Full-Physics-Support&p=251216&viewfull=1#post251216"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"rama-video-training-physx-simulating-balls-to-navigate-narrow-ledges"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rama-video-training-physx-simulating-balls-to-navigate-narrow-ledges"}},[e._v("#")]),e._v(" Rama Video ~ Training PhysX Simulating Balls to Navigate Narrow Ledges!")]),e._v(" "),a("p",[e._v("In this video you can see that I use a custom path following component ( as explained in this wiki ) to enable PhysX simulating characters to navigate narrow ledges!")]),e._v(" "),a("h2",{attrs:{id:"steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#steps"}},[e._v("#")]),e._v(" Steps")]),e._v(" "),a("p",[e._v("You need to do several things")]),e._v(" "),a("h3",{attrs:{id:"have-your-own-custom-ai-controller-extends-aaicontroller"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#have-your-own-custom-ai-controller-extends-aaicontroller"}},[e._v("#")]),e._v(" Have your own Custom ai controller (extends AAIController)")]),e._v(" "),a("p",[e._v("Here's the required header info")]),e._v(" "),a("p",[e._v('#pragma once\n \n//Super\n#include "AIController.h"\n \n#include "JoyController.generated.h"\n \n \nUCLASS()\nclass AJoyController : public AAIController\n{\nGENERATED_BODY()\npublic:\nAJoyController(const FObjectInitializer& ObjectInitializer);')]),e._v(" "),a("h3",{attrs:{id:"tell-ai-controller-to-use-custom-path-following-component-which-extends-the-base-ue4-class"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tell-ai-controller-to-use-custom-path-following-component-which-extends-the-base-ue4-class"}},[e._v("#")]),e._v(" Tell ai controller to use custom path following component, which extends the base UE4 class")]),e._v(" "),a("p",[e._v("Here's the code for that, you just modify the constructor")]),e._v(" "),a("p",[e._v('//\t\tUJoyPathFollowComp is used here!\nAJoyController::AJoyController(const FObjectInitializer& ObjectInitializer)\n: Super(ObjectInitializer.SetDefaultSubobjectClass<UJoyPathFollowComp>(TEXT("PathFollowingComponent")))\n{')]),e._v(" "),a("h3",{attrs:{id:"make-sure-your-build-cs-is-including-aimodule-as-part-of-your-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#make-sure-your-build-cs-is-including-aimodule-as-part-of-your-dependencies"}},[e._v("#")]),e._v(" Make sure your build.cs is including AIModule as part of your dependencies")]),e._v(" "),a("p",[e._v('PublicDependencyModuleNames.AddRange(new string[] {\n"Core",\n"CoreUObject",\n"Engine",\n"InputCore" ,\n"Landscape",\n"UMG",\n \n"PhysX",  "APEX",\n \n"AIModule"      //<~~~~~~\n});')]),e._v(" "),a("h3",{attrs:{id:"override-these-functions-in-your-custom-pathfollowingcomponent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#override-these-functions-in-your-custom-pathfollowingcomponent"}},[e._v("#")]),e._v(" Override these functions in your custom PathFollowingComponent!")]),e._v(" "),a("p",[e._v("Especially FollowPathSegment !")]),e._v(" "),a("p",[e._v("This is where you can take control of exact pathing methods!")]),e._v(" "),a("p",[e._v("//~~~~~~~~~~~~~~~~~~~~~~~~~~~\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~\n//\t  Per Tick Modification of Path Following\n//\t\t\tthis is how you really customize\n//\t\t\t\thow units follow the path!\n \n/** follow current path segment */\nvirtual void FollowPathSegment(float DeltaTime) override;\n \n/** sets variables related to current move segment */\nvirtual void SetMoveSegment(int32 SegmentStartIndex) override;\n \n/** check state of path following, update move segment if needed */\nvirtual void UpdatePathSegment() override;")]),e._v(" "),a("h2",{attrs:{id:"video-result"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#video-result"}},[e._v("#")]),e._v(" Video Result")]),e._v(" "),a("p",[e._v("Using the above method is how I made custom C++ Jump pathing calculations that dont need any in-editor additions to the level, just the basic nav mesh volume.")]),e._v(" "),a("h2",{attrs:{id:"more-of-ny-customized-c-ai-pathing-videos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#more-of-ny-customized-c-ai-pathing-videos"}},[e._v("#")]),e._v(" More of Ny Customized C++ AI Pathing Videos")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://forums.unrealengine.com/showthread.php?25410-Rama-s-Multi-Threaded-Dynamic-Pathing-System-Full-Physics-Support&p=129896&viewfull=1#post129896",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rama's C++ Jump Pathing Videos"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"how-to-get-all-ue4-navigation-polys"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-get-all-ue4-navigation-polys"}},[e._v("#")]),e._v(" How to Get All UE4 Navigation Polys")]),e._v(" "),a("p",[e._v("In the video above you will see I get all the UE4 Nav Polys in order to do all my C++ AI Jump calculations!")]),e._v(" "),a("p",[e._v("Here's the function I wrote to do this, just for you!")]),e._v(" "),a("p",[e._v('//Nav Data Main\nFORCEINLINE const ANavigationData* GetMainNavData(FNavigationSystem::ECreateIfEmpty CreateNewIfNoneFound)\n{\nUNavigationSystem* NavSys = GetWorld()->GetNavigationSystem();\nif(!NavSys) return NULL;\nreturn NavSys->GetMainNavData(CreateNewIfNoneFound);\n}\n \n//Choose Which Nav Data To Use\nFORCEINLINE const ANavigationData* JoyGetNavData() const\n{\nconst FNavAgentProperties& AgentProperties = MovementComp->GetNavAgentPropertiesRef() ;\nconst ANavigationData* NavData = GetNavDataForProps(AgentProperties) ;\nif (NavData == NULL)\n{\nVSCREENMSG("ERROR USING MAIN NAV DATA");\nNavData = GetMainNavData();\n}\n \nreturn NavData;\n}\n \n//VERY IMPORTANT FOR CRASH PROTECTION !!!!!\nFORCEINLINE bool TileIsValid(const ARecastNavMesh* NavMesh,int32 TileIndex) const\n{\nif(!NavMesh) return false;\n//~~~~~~~~~~~~~~\nconst FBox TileBounds = NavMesh->GetNavMeshTileBounds(TileIndex);\n \nreturn TileBounds.IsValid != 0;\n}\n \n//add this to your custom path follow component!\nbool NavPoly_GetAllPolys(TArray<NavNodeRef>& Polys);')]),e._v(" "),a("p",[e._v("//Rama's UE4 Nav code to get all the nav polys!\nbool UJoyPathFollowComp::NavPoly_GetAllPolys(TArray<NavNodeRef>& Polys)\n{\nif(!MovementComp) return false;\n//~~~~~~~~~~~~~~~~~~\n \n//Get Nav Data\nconst ANavigationData* NavData = JoyGetNavData();\n \nconst ARecastNavMesh* NavMesh = Cast<ARecastNavMesh>(NavData);\nif(!NavMesh)\n{\nreturn false;\n}\n \nTArray<FNavPoly> EachPolys;\nfor(int32 v = 0; v < NavMesh->GetNavMeshTilesCount(); v++)\n{\n \n//CHECK IS VALID FIRST OR WILL CRASH!!!\n//     256 entries but only few are valid!\n// use continue in case the valid polys are not stored sequentially\nif(!TileIsValid(NavMesh,v))\n{\ncontinue;\n}\t\n \nNavMesh->GetPolysInTile(v,EachPolys);\n}\t\n \n \n//Add them all!\nfor(int32 v = 0; v < EachPolys.Num(); v++)\n{\nPolys.Add(EachPolys[v].Ref);\n}\n}")]),e._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),a("p",[e._v("Have fun writing your own custom Path Following code that integrates with the UE4 standard Path Following code!")]),e._v(" "),a("p",[e._v("Now you can extend the wonderful foundation that the AI engineers at Epic built for you!")]),e._v(" "),a("p",[e._v("Enjoy!")]),e._v(" "),a("p",[a("a",{attrs:{href:"/User:Rama",title:"User:Rama"}},[e._v("Rama")]),e._v(" ("),a("a",{attrs:{href:"/User_talk:Rama",title:"User talk:Rama"}},[e._v("talk")]),e._v(")")]),e._v(" "),a("p",[e._v('Retrieved from "'),a("a",{attrs:{href:"https://wiki.unrealengine.com/index.php?title=AI_Navigation_in_C%2B%2B,_Customize_Path_Following_Every_Tick&oldid=13958",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://wiki.unrealengine.com/index.php?title=AI_Navigation_in_C%2B%2B,_Customize_Path_Following_Every_Tick&oldid=13958"),a("OutboundLink")],1),e._v('"')]),e._v(" "),a("p",[a("a",{attrs:{href:"/Special:Categories",title:"Special:Categories"}},[e._v("Category")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"/Category:Code",title:"Category:Code"}},[e._v("Code")])])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://tracking.unrealengine.com/track.png",alt:""}})])])}),[],!1,null,null,null);t.default=n.exports}}]);
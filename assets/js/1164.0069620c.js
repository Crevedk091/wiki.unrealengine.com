(window.webpackJsonp=window.webpackJsonp||[]).push([[1164],{1098:function(e,t,a){"use strict";a.r(t);var o=a(28),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("Unreal Engine AI Tutorial - 1 - Making AI Jump as a Part of Path Following - Epic Wiki")]),e._v(" "),a("h1",{attrs:{id:"unreal-engine-ai-tutorial-1-making-ai-jump-as-a-part-of-path-following"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unreal-engine-ai-tutorial-1-making-ai-jump-as-a-part-of-path-following"}},[e._v("#")]),e._v(" Unreal Engine AI Tutorial - 1 - Making AI Jump as a Part of Path Following")]),e._v(" "),a("p",[e._v("From Epic Wiki")]),e._v(" "),a("p",[e._v("Jump to: "),a("a",{attrs:{href:"#mw-head"}},[e._v("navigation")]),e._v(", "),a("a",{attrs:{href:"#p-search"}},[e._v("search")])]),e._v(" "),a("p",[e._v("Authored by: Mieszko Zielinski")]),e._v(" "),a("p",[e._v("The very first thing I want to cover in this tutorial series is how to make AI know when to jump when following a navigation path. This tutorial is using C++ approach.")]),e._v(" "),a("p",[e._v("There's also an alternative way of achieving jump behavior, and that's by placing SmartNavigationLinks on the level, doable purely in Blueprint, but this will get covered in one of the upcoming tutorials.")]),e._v(" "),a("p",[e._v("There are three steps required to achieve this tutorial's goal.")]),e._v(" "),a("h3",{attrs:{id:"_1-implement-a-special-jump-navigation-area"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-implement-a-special-jump-navigation-area"}},[e._v("#")]),e._v(' 1. Implement a special "jump" navigation area')]),e._v(" "),a("p",[e._v("One of the ways of annotating navmesh in UE4 is by applying navigation area types to it. There'll be a in-depth tutorial on navigation areas so I'll just say areas can apply a specific set of flags and costs to the navigation mesh.")]),e._v(" "),a("p",[e._v("Creating a navigation area is very straightforward. Just create a class deriving from UNavArea, like so:")]),e._v(" "),a("p",[a("code",[e._v("UCLASS() class UNavArea_JumpÂ : public UNavArea { GENERATED_UCLASS_BODY() };")])]),e._v(" "),a("p",[e._v('We\'ll also need to name our "jump" flag so that we can consistently use it throughout our code. Like so:')]),e._v(" "),a("p",[a("code",[e._v("UENUM() namespace ENavAreaFlag { // up to 15 values enum Type { Default, Jump, Crouch, // and what not }; }")])]),e._v(" "),a("p",[e._v("Note that we're not using the first bit, since it has a special meaning in our navmesh internals. If first bit in a area is set it means it's walkable, and it's treated as not walkable otherwise. Let's also implement some helper functions for operating on area flags:")]),e._v(" "),a("p",[e._v("`namespace FNavAreaHelper\n{\nFORCEINLINE bool IsSet(uint16 Flags, ENavAreaFlag::Type Bit) { return (Flags & (1 << Bit))Â != 0; }\nFORCEINLINE void Set(uint16& Flags, ENavAreaFlag::Type Bit) { Flags |= (1 << Bit); }")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("   FORCEINLINE bool IsNavLink(const FNavPathPoint& PathVert) { return (FNavMeshNodeFlags(PathVert.Flags).PathFlags & RECAST_STRAIGHTPATH_OFFMESH_CONNECTION)Â != 0; }\n   FORCEINLINE bool HasJumpFlag(const FNavPathPoint& PathVert) { return     IsSet(FNavMeshNodeFlags(PathVert.Flags).AreaFlags, ENavAreaFlag::Jump); }\n   FORCEINLINE bool HasCrouchFlag(const FNavPathPoint& PathVert) { return IsSet(FNavMeshNodeFlags(PathVert.Flags).AreaFlags, ENavAreaFlag::Crouch); }\n")])])]),a("p",[e._v("}`")]),e._v(" "),a("p",[e._v("Next we need to configure our newly created area class by setting its AreaFlags. We do it in UNavArea_Jump's constructor.")]),e._v(" "),a("p",[a("code",[e._v("UNavArea_Jump::UNavArea_Jump(const class FPostConstructInitializeProperties& PCIP) Â : Super(PCIP) { FNavAreaHelper::Set(AreaFlags, ENavAreaFlag::Jump); }")])]),e._v(" "),a("p",[e._v("Compile, run, and that's it, jumping area is ready.")]),e._v(" "),a("h3",{attrs:{id:"_2-implement-a-special-path-following-component-for-detecting-jump-links"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-implement-a-special-path-following-component-for-detecting-jump-links"}},[e._v("#")]),e._v(" 2. Implement a special path following component for detecting jump links.")]),e._v(" "),a("p",[e._v("This is the most fun part. We need to create a custom path following component to handle jumping. We will reuse this new path following component in future tutorials, by the way.")]),e._v(" "),a("p",[e._v("We need our new path following component to derive from "),a("strong",[e._v("UPathFollowingComponent")]),e._v(". Let's make a class like that and name it "),a("strong",[e._v("UTutorialPathFollowingComponent")]),e._v(". The function we need to override to be able to detect jumping is "),a("strong",[e._v("SetMoveSegment")]),e._v(" so let's declare that as well. Class declaration should look like this:")]),e._v(" "),a("p",[e._v("`UCLASS()\nclass UTutorialPathFollowingComponentÂ : public UPathFollowingComponent\n{\nGENERATED_UCLASS_BODY()")]),e._v(" "),a("p",[e._v("protected:\n/** cached UCharacterMovementComponent "),a("em",[e._v("/\nUPROPERTY(transient)\nUCharacterMovementComponent")]),e._v(" CharacterMoveComp;")]),e._v(" "),a("p",[e._v("public:\n// used to detect properties of a path's segment a character is about to follow\nvirtual void SetMoveSegment(int32 SegmentStartIndex) override;")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("   // used to cache UCharacterMovementComponent we're using in SetMoveSegment implementation\n   virtual void SetMovementComponent(UNavMovementComponent* MoveComp) override;\n")])])]),a("p",[e._v("};`")]),e._v(" "),a("p",[e._v("Implementation of "),a("strong",[e._v("SetMoveSegment")]),e._v(" is the heart of making AI jump in this tutorial. It should look like this:")]),e._v(" "),a("p",[e._v("`void UTutorialPathFollowingComponent::SetMoveSegment(int32 SegmentStartIndex)\n{\nSuper::SetMoveSegment(SegmentStartIndex);")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("   if (CharacterMoveCompÂ != NULL)\n   {\n       const FNavPathPoint& SegmentStart = Path->PathPoints[MoveSegmentStartIndex];\n\n       if (FNavAreaHelper::HasJumpFlag(SegmentStart))\n       {\n           // jump! well... fly-in-straight-line!\n           CharacterMoveComp->SetMovementMode(MOVE_Flying);\n       }\n       else\n       {\n           // regular move\n           CharacterMoveComp->SetMovementMode(MOVE_Walking);\n       }\n   }\n")])])]),a("p",[e._v("}`")]),e._v(" "),a("p",[e._v("Remember you can find missing code details at tutorial's "),a("a",{attrs:{href:"https://github.com/MieszkoZ/AITutorialCPP/commit/99450d6cc742f8cfe164c585f8b9c59b41208b03",target:"_blank",rel:"noopener noreferrer"}},[e._v("Github repository"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"_3-make-ai-use-the-new-component"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-make-ai-use-the-new-component"}},[e._v("#")]),e._v(" 3. Make AI use the new component")]),e._v(" "),a("p",[e._v("This one's easy, but not obvious. To make AI use "),a("strong",[e._v("UTutorialPathFollowingComponent")]),e._v(" we need to implement a new AI controller class and configure it to use the new component. Create a class deriving from "),a("strong",[e._v("AAIController")]),e._v(" (let's call it "),a("strong",[e._v("ATutorialAIController")]),e._v(") and implement its constructor like so:")]),e._v(" "),a("p",[a("code",[e._v('ATutorialAIController::ATutorialAIController(const FPostConstructInitializeProperties& PCIP) Â : Super(PCIP.SetDefaultSubobjectClass<UTutorialPathFollowingComponent>(TEXT("PathFollowingComponent"))) { }')])]),e._v(" "),a("p",[e._v('This has to be done this way since PathFollowingComponent is the AIController\'s "sub-object pointer" which means we expect it to be set to an actual object instance all the time.')]),e._v(" "),a("h3",{attrs:{id:"level-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#level-setup"}},[e._v("#")]),e._v(" Level setup")]),e._v(" "),a("p",[e._v("One last thing that needs to be done to observe our AI enjoy its newly acquired jumping skill is to have some actual level with jump links.")]),e._v(" "),a("p",[e._v("The easiest way to create navigation links on a map is by placing "),a("strong",[e._v("NavLinkProxy")]),e._v(" actors on it (just drag&drop them from the ClassView in the editor). To make these links jump-able you need to modify selected link's properties to use our newly created navigation:")]),e._v(" "),a("p",[a("a",{attrs:{href:"/index.php?title=File:AreaClass_Jump.png"}},[a("img",{attrs:{src:"https://d26ilriwvtzlb.cloudfront.net/7/78/AreaClass_Jump.png",alt:"AreaClass Jump.png"}})])]),e._v(" "),a("p",[e._v("Check out "),a("strong",[e._v("T01_Jump")]),e._v(" in "),a("a",{attrs:{href:"http://miechu.nazwa.pl/aitutorial_joomla/repo/AITutorial01_Jump.zip",target:"_blank",rel:"noopener noreferrer"}},[e._v("this tutorial's content package"),a("OutboundLink")],1)]),e._v(" "),a("h3",{attrs:{id:"summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[e._v("#")]),e._v(" Summary")]),e._v(" "),a("p",[e._v('We\'ve created a way to annotate navmesh with additional information and a way to have AI use that knowledge. Feel free to implement a more sophisticated move in place of my "flying jump"Â ðŸ˜‰')]),e._v(" "),a("p",[e._v("Feel free to suggest new thing I should tackle in this tutorial series. I have a little list to cover, but if your request is on the list then it will get covered even sooner. If it's not I'll handle it once the list is empty. If a feature is widely requested it will make it to the list!Â ðŸ˜ƒ)")]),e._v(" "),a("p",[e._v("And keep the feedback coming!")]),e._v(" "),a("p",[e._v("Cheers!")]),e._v(" "),a("p",[e._v('Retrieved from "'),a("a",{attrs:{href:"https://wiki.unrealengine.com/index.php?title=Unreal_Engine_AI_Tutorial_-_1_-_Making_AI_Jump_as_a_Part_of_Path_Following&oldid=505",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://wiki.unrealengine.com/index.php?title=Unreal_Engine_AI_Tutorial_-_1_-_Making_AI_Jump_as_a_Part_of_Path_Following&oldid=505"),a("OutboundLink")],1),e._v('"')]),e._v(" "),a("p",[a("a",{attrs:{href:"/index.php?title=Special:Categories",title:"Special:Categories"}},[e._v("Category")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"/index.php?title=Category:Tutorials&action=edit&redlink=1",title:"Category:Tutorials (page does not exist)"}},[e._v("Tutorials")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);
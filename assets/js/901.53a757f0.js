(window.webpackJsonp=window.webpackJsonp||[]).push([[901],{688:function(e,t,s){"use strict";s.r(t);var r=s(28),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("PhysX, Integrating PhysX Code into Your Project - Epic Wiki")]),e._v(" "),s("h1",{attrs:{id:"physx-integrating-physx-code-into-your-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physx-integrating-physx-code-into-your-project"}},[e._v("#")]),e._v(" PhysX, Integrating PhysX Code into Your Project")]),e._v(" "),s("p",[e._v("From Epic Wiki")]),e._v(" "),s("p",[e._v("Jump to: "),s("a",{attrs:{href:"#mw-head"}},[e._v("navigation")]),e._v(", "),s("a",{attrs:{href:"#p-search"}},[e._v("search")])]),e._v(" "),s("h2",{attrs:{id:"contents"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#contents"}},[e._v("#")]),e._v(" Contents")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#Overview"}},[e._v("1 Overview")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#PhysX_3.3_Source_Code_For_UE4_Developers"}},[e._v("2 PhysX 3.3 Source Code For UE4 Developers")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#Compiling_the_PhysX_Source_Code"}},[e._v("3 Compiling the PhysX Source Code")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#Video_of_a_PhysX_Vortex_Spiral_in_UE4"}},[e._v("4 Video of a PhysX Vortex Spiral in UE4")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#Pics"}},[e._v("5 Pics")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#Custom_Destructible_Mesh_Class"}},[e._v("6 Custom Destructible Mesh Class")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#HappyDestructible.h"}},[e._v("6.1 HappyDestructible.h")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#HappyDestructible.cpp"}},[e._v("6.2 HappyDestructible.cpp")])])])]),e._v(" "),s("li",[s("a",{attrs:{href:"#Packaging"}},[e._v("7 Packaging")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#PhysX_.7E_Basic"}},[e._v("8 PhysX ~ Basic")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#Build.CS"}},[e._v("8.1 Build.CS")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#The_Essential_Include"}},[e._v("8.2 The Essential Include")])])])]),e._v(" "),s("li",[s("a",{attrs:{href:"#PhysX_.7E_Advanced"}},[e._v("9 PhysX ~ Advanced")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#PhysicsPublic.h"}},[e._v("9.1 PhysicsPublic.h")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#PhysXSupport.h_for_Scene_Read.2FWrite_Locking"}},[e._v("9.2 PhysXSupport.h for Scene Read/Write Locking")])])])]),e._v(" "),s("li",[s("a",{attrs:{href:"#PhysX_.7E_How_to_Get_the_PhysX_Scene_.26_WRITE.2FREAD_LOCK"}},[e._v("10 PhysX ~ How to Get the PhysX Scene & WRITE/READ LOCK")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#UE4_4.15.2B_Entry_PhysX_Points_Into_UE4_Engine"}},[e._v("11 UE4 4.15+ Entry PhysX Points Into UE4 Engine")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#Conclusion"}},[e._v("12 Conclusion")])])]),e._v(" "),s("h2",{attrs:{id:"overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),s("p",[s("em",[e._v("Author:")]),e._v(" "),s("a",{attrs:{href:"/index.php?title=User:Rama",title:"User:Rama"}},[e._v("Rama")]),e._v(" ("),s("a",{attrs:{href:"/index.php?title=User_talk:Rama",title:"User talk:Rama"}},[e._v("talk")]),e._v(")")]),e._v(" "),s("p",[e._v("In this tutorial I am showing you how you can work with Nvidia PhysX directly in your UE4 code base!")]),e._v(" "),s("p",[e._v("I provide sample code that iterates over all the destructible chunks of a DestructibleComponent and draws their current world space positions to the screen!")]),e._v(" "),s("h2",{attrs:{id:"physx-3-3-source-code-for-ue4-developers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physx-3-3-source-code-for-ue4-developers"}},[e._v("#")]),e._v(" PhysX 3.3 Source Code For UE4 Developers")]),e._v(" "),s("p",[e._v("Nvidia has made PhysX3.3 Open Source for all Unreal Engine 4 Developers!")]),e._v(" "),s("p",[e._v("Here's the link to the PhysX 3.3 Source Code")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/EpicGames/UnrealEngine/tree/master/Engine/Source/ThirdParty/PhysX/PhysX-3.3/Source",target:"_blank",rel:"noopener noreferrer"}},[e._v("PhysX3.3 Source Code"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("strong",[e._v("edit:")]),e._v(" the link is broken but PhysX source code is in the UnrealEngine repo under .../Source/ThirdParty/PhysX/")]),e._v(" "),s("p",[e._v("You must be signed in to a "),s("strong",[e._v("UE4-Linked Github account")]),e._v(" to view the above link!")]),e._v(" "),s("p",[e._v("Simply sign up for Unreal Engine 4 and then follow the steps to link your github account to UE4.")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.unrealengine.com/ue4-on-github",target:"_blank",rel:"noopener noreferrer"}},[e._v("UE4 Gitub Setup"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"compiling-the-physx-source-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compiling-the-physx-source-code"}},[e._v("#")]),e._v(" Compiling the PhysX Source Code")]),e._v(" "),s("p",[e._v("Here's how to compile PhysX source code for UE4 as of 4.8!")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://wiki.unrealengine.com/PhysX_Source_Guide",target:"_blank",rel:"noopener noreferrer"}},[e._v("Compiling PhysX Source Code for UE4"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"video-of-a-physx-vortex-spiral-in-ue4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#video-of-a-physx-vortex-spiral-in-ue4"}},[e._v("#")]),e._v(" Video of a PhysX Vortex Spiral in UE4")]),e._v(" "),s("p",[e._v("In this video I am programmatically arranging apex pieces after the mesh is destroyed and the pieces bounce around normally.")]),e._v(" "),s("p",[e._v("I am arranging the pieces into a spiral/vortex formation!")]),e._v(" "),s("p",[e._v("Please notice that the apex pieces continue to have collision with the world and even each other, after I begin spinning them myself via C++!")]),e._v(" "),s("p",[e._v("This is all done via PhysX coding!")]),e._v(" "),s("p",[e._v("There is "),s("strong",[e._v("no measurable performance")]),e._v(" hit with my current method, my frame rate stays solid at maxÂ ðŸ˜ƒ")]),e._v(" "),s("p",[e._v("In other words, I literally cannot detect any drop in performance even after I start the PhysX coding that you see in video below!")]),e._v(" "),s("p",[s("youtube",[s("a",{attrs:{href:"https://www.youtube.com/watch?v=7KpkQPhvBKA",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.youtube.com/watch?v=7KpkQPhvBKA"),s("OutboundLink")],1)])],1),e._v(" "),s("p",[e._v("This video is from my Abatron work in progress thread, "),s("a",{attrs:{href:"https://forums.unrealengine.com/showthread.php?45059-Abatron-the-making-of-a-UE4-Hybrid-game-",target:"_blank",rel:"noopener noreferrer"}},[e._v("UE4 Forum Link: Abatron"),s("OutboundLink")],1),e._v("&p=176126#post176126)")]),e._v(" "),s("h2",{attrs:{id:"pics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pics"}},[e._v("#")]),e._v(" Pics")]),e._v(" "),s("p",[e._v("Below you can see I am drawing to screen the world space positions of each chunk of a Destructible Mesh using the PhysX code!")]),e._v(" "),s("p",[e._v("Some of the points can't be seen cause they are hidden inside the little piecesÂ ðŸ˜ƒ")]),e._v(" "),s("p",[e._v("But you can also see I am displaying the locations to the screen! Yay!")]),e._v(" "),s("p",[s("a",{attrs:{href:"/index.php?title=File:NvdiaUE4CPP1.jpg"}},[s("img",{attrs:{src:"https://d3ar1piqh1oeli.cloudfront.net/5/56/NvdiaUE4CPP1.jpg/900px-NvdiaUE4CPP1.jpg",alt:"NvdiaUE4CPP1.jpg"}})])]),e._v(" "),s("p",[e._v("Below I added a vertical offset to make the points visible for all chunks!")]),e._v(" "),s("p",[s("a",{attrs:{href:"/index.php?title=File:PhysXUE4CPP2.jpg"}},[s("img",{attrs:{src:"https://d3ar1piqh1oeli.cloudfront.net/0/09/PhysXUE4CPP2.jpg/900px-PhysXUE4CPP2.jpg",alt:"PhysXUE4CPP2.jpg"}})])]),e._v(" "),s("p",[e._v("Enjoy!")]),e._v(" "),s("h2",{attrs:{id:"custom-destructible-mesh-class"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#custom-destructible-mesh-class"}},[e._v("#")]),e._v(" Custom Destructible Mesh Class")]),e._v(" "),s("p",[e._v("Here's a custom destructible mesh class you can use to test whether you got the PhysX code setup properly!")]),e._v(" "),s("p",[e._v("This is the code I used for the picture above!")]),e._v(" "),s("h3",{attrs:{id:"happydestructible-h"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#happydestructible-h"}},[e._v("#")]),e._v(" HappyDestructible.h")]),e._v(" "),s("syntaxhighlight",{attrs:{lang:"cpp"}},[s("ol",[s("li",[s("p",[e._v("pragma once")])]),e._v(" "),s("li",[s("p",[e._v('include "HappyDestructible.generated.h"')])])]),e._v(" "),s("p",[e._v("UCLASS() class AHappyDestructibleÂ : public ADestructibleActor { GENERATED_UCLASS_BODY()")]),e._v(" "),s("p",[e._v("protected: virtual void Tick(float DeltaTime) override;")]),e._v(" "),s("p",[e._v("//Drawing! public: FORCEINLINE void DrawPoint ( const FVector& Loc, const float& Size = 7, const FColor& Color = FColor::Red, const float Duration=-1.f ) const { DrawDebugPoint( GetWorld(), Loc, Size, //thickness Color, false, Duration ); }")]),e._v(" "),s("p",[e._v("FORCEINLINE void ScreenMsg(const FString& Msg) { GEngine->AddOnScreenDebugMessage(-1, 5.f, FColor::Red, *Msg); }")]),e._v(" "),s("p",[e._v('FORCEINLINE void ScreenMsg(const FString& Msg, const FString& Msg2) { GEngine->AddOnScreenDebugMessage(-1, 5.f, FColor::Red, FString::Printf(TEXT("%sÂ %s"), *Msg, *Msg2)); }')]),e._v(" "),s("p",[e._v("}; ")])]),s("p"),e._v(" "),s("h3",{attrs:{id:"happydestructible-cpp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#happydestructible-cpp"}},[e._v("#")]),e._v(" HappyDestructible.cpp")]),e._v(" "),s("syntaxhighlight",{attrs:{lang:"cpp"}},[s("ol",[s("li",[e._v('include "YourGame.h"')]),e._v(" "),s("li",[e._v('include "HappyDestructible.h"')])]),e._v(" "),s("p",[e._v("//~~~~~~~~~~~~~~~~~~~~~~~~ // PhysX")]),e._v(" "),s("ol",[s("li",[e._v('include "PhysXIncludes.h"')])]),e._v(" "),s("p",[e._v("//~~~~~~~~~~~~~~~~~~~~~~~~")]),e._v(" "),s("p",[e._v("AHappyDestructible::AHappyDestructible(const class FPostConstructInitializeProperties& PCIP)Â : Super(PCIP) {")]),e._v(" "),s("p",[e._v("}")]),e._v(" "),s("p",[e._v("//Tick void AHappyDestructible::Tick(float DeltaTime) { Super::Tick(DeltaTime); //~~~~~~~~~~~~")]),e._v(" "),s("p",[e._v('//Draw All Centers to the screen! #if WITH_PHYSX ScreenMsg("Got into PhysX!!!");')]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("   //4.8 Version\n")])])]),s("p",[e._v("uint32 ChunkCount = DestructibleComponent->ApexDestructibleActor->getNumVisibleChunks(); const uint16* ChunkIndices = DestructibleComponent->ApexDestructibleActor->getVisibleChunks(); for(uint32 c = 0; c < ChunkCount; c++) { PxRigidDynamic* PActor = DestructibleComponent->ApexDestructibleActor->getChunkPhysXActor(ChunkIndices[c]); check(PActor); PxTransform Trans = PActor->getGlobalPose(); PxVec3& PxLoc = Trans.p;")]),e._v(" "),s("p",[e._v("FVector Location(PxLoc.x,PxLoc.y,PxLoc.z);")]),e._v(" "),s("p",[e._v("DrawPoint(Location);")]),e._v(" "),s("p",[e._v('ScreenMsg("physx loc", Location.ToString()); }')]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("   /\\* PRE 4.8 Version\n")])])]),s("p",[e._v("for(FDestructibleChunkInfo& EachÂ : DestructibleComponent->ChunkInfos) { physx::PxRigidDynamic* Actor = Each.Actor;")]),e._v(" "),s("p",[e._v("if(Actor) { PxTransform Trans = Actor->getGlobalPose(); PxVec3& PxLoc = Trans.p;")]),e._v(" "),s("p",[e._v("FVector Location(PxLoc.x,PxLoc.y,PxLoc.z);")]),e._v(" "),s("p",[e._v("DrawPoint(Location);")]),e._v(" "),s("p",[e._v('ScreenMsg("physx loc", Location.ToString()); } }')]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("   \\*/\n#endif // WITH\\_PHYSX \n")])])]),s("p",[e._v("} ")])]),s("p"),e._v(" "),s("h2",{attrs:{id:"packaging"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#packaging"}},[e._v("#")]),e._v(" Packaging")]),e._v(" "),s("p",[e._v("I can verify that the code I've shared packages just fine into a full release game!")]),e._v(" "),s("h2",{attrs:{id:"physx-basic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physx-basic"}},[e._v("#")]),e._v(" PhysX ~ Basic")]),e._v(" "),s("h3",{attrs:{id:"build-cs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#build-cs"}},[e._v("#")]),e._v(" Build.CS")]),e._v(" "),s("p",[e._v("You will need the following to work with Nvidia Apex:")]),e._v(" "),s("p",[s("syntaxhighlight",{attrs:{lang:"cpp"}},[e._v(' PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore",')])],1),e._v(" "),s("p",[e._v('"PhysX", "APEX" //PhysX')]),e._v(" "),s("p",[e._v("}); ")]),e._v(" "),s("h3",{attrs:{id:"the-essential-include"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-essential-include"}},[e._v("#")]),e._v(" The Essential Include")]),e._v(" "),s("p",[e._v("You can include this in your .cpp or .h if you define any Px vars in your .h files.")]),e._v(" "),s("p",[s("syntaxhighlight",{attrs:{lang:"cpp"}},[e._v(" //PhysX")])],1),e._v(" "),s("ol",[s("li",[e._v('include "PhysXIncludes.h"')])]),e._v(" "),s("h2",{attrs:{id:"physx-advanced"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physx-advanced"}},[e._v("#")]),e._v(" PhysX ~ Advanced")]),e._v(" "),s("h3",{attrs:{id:"physicspublic-h"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physicspublic-h"}},[e._v("#")]),e._v(" PhysicsPublic.h")]),e._v(" "),s("syntaxhighlight",{attrs:{lang:"cpp"}},[s("ol",[s("li",[e._v('include "PhysicsPublic.h" //FPhysScene')]),e._v(" "),s("li",[e._v('include "PhysXPublic.h" //PtoU conversions')])])]),e._v(" "),s("p",[e._v("These include give you access to the conversion functions from PhysX to Unreal and back for various essential types like FVector / PxVec3")]),e._v(" "),s("h3",{attrs:{id:"physxsupport-h-for-scene-read-write-locking"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physxsupport-h-for-scene-read-write-locking"}},[e._v("#")]),e._v(" PhysXSupport.h for Scene Read/Write Locking")]),e._v(" "),s("p",[s("syntaxhighlight",{attrs:{lang:"cpp"}},[e._v(" //For Scene Locking using Epic's awesome helper macros like SCOPED_SCENE_READ_LOCK")])],1),e._v(" "),s("ol",[s("li",[e._v('include "Runtime/Engine/Private/PhysicsEngine/PhysXSupport.h"')])]),e._v(" "),s("p",[e._v("This include is absolutely essential if you want to do any "),s("strong",[e._v("low-level multi-threaded PhysX coding")]),e._v("!")]),e._v(" "),s("p",[e._v("Epic has created some wonderful macros to make it fast to create scoped read/write locks of the PhysX scene, for example see below!")]),e._v(" "),s("h2",{attrs:{id:"physx-how-to-get-the-physx-scene-write-read-lock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physx-how-to-get-the-physx-scene-write-read-lock"}},[e._v("#")]),e._v(" PhysX ~ How to Get the PhysX Scene & WRITE/READ LOCK")]),e._v(" "),s("p",[e._v("Here's some sample code I'v written for how you can get the PhysX scene if you have the UE4 UWorld*Â !")]),e._v(" "),s("p",[s("syntaxhighlight",{attrs:{lang:"cpp"}},[e._v(" void SomeClass::SomeFunction(UWorld* World) {")])],1),e._v(" "),s("p",[e._v("check(World);\n//if crash here world was not valid, needs to be investigated, did it come from a UObject?")]),e._v(" "),s("p",[e._v("FPhysScene* PhysScene = World->GetPhysicsScene();\nif(!PhysScene) return;")]),e._v(" "),s("p",[e._v("// Scene Lock for Multi-Threading\nPxScene* SyncScene = PhysScene->GetPhysXScene(PST_Sync);\nSCOPED_SCENE_WRITE_LOCK(SyncScene); //or SCOPED_SCENE_READ_LOCK if you only need to read")]),e._v(" "),s("p",[e._v("//now you can use the PhysX scene in multi-threaded fashion within this function context!\n//  -Rama")]),e._v(" "),s("p",[e._v("} ")]),e._v(" "),s("p",[e._v("Yay!")]),e._v(" "),s("h2",{attrs:{id:"ue4-4-15-entry-physx-points-into-ue4-engine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ue4-4-15-entry-physx-points-into-ue4-engine"}},[e._v("#")]),e._v(" UE4 4.15+ Entry PhysX Points Into UE4 Engine")]),e._v(" "),s("p",[e._v("As of 4.15 there are new entry points you can use to write a physX-related plugin or game project and interact with UE4's integration of PhysX!")]),e._v(" "),s("p",[e._v('"We have now refactored our PhysX Vehicle support as an optional plugin! This makes it easy for games that are not using vehicles to exclude this feature and save disk space and memory. This work also adds several useful physics extension points to Engine (e.g. '),s("strong",[e._v("OnPhysSceneInit")]),e._v("/Term, "),s("strong",[e._v("OnPhysSceneStep")]),e._v(') to make it easier for other developers to write their own similar systems."')]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.unrealengine.com/blog/unreal-engine-4-15-released",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.unrealengine.com/blog/unreal-engine-4-15-released"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"conclusion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),s("p",[e._v("Using the same UE4 class code, the build cs additions, and #includes I've shown above, you can now write any PhysX code you want!")]),e._v(" "),s("p",[e._v("Using the PhysX Scene access code I've shown above, you can do lowest level multi-threaded PhysX coding!")]),e._v(" "),s("p",[e._v("Have fun!")]),e._v(" "),s("p",[s("a",{attrs:{href:"/index.php?title=User:Rama",title:"User:Rama"}},[e._v("Rama")]),e._v(" ("),s("a",{attrs:{href:"/index.php?title=User_talk:Rama",title:"User talk:Rama"}},[e._v("talk")]),e._v(")")]),e._v(" "),s("p",[e._v('Retrieved from "'),s("a",{attrs:{href:"https://wiki.unrealengine.com/index.php?title=PhysX,_Integrating_PhysX_Code_into_Your_Project&oldid=337",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://wiki.unrealengine.com/index.php?title=PhysX,_Integrating_PhysX_Code_into_Your_Project&oldid=337"),s("OutboundLink")],1),e._v('"')]),e._v(" "),s("p",[s("a",{attrs:{href:"/index.php?title=Special:Categories",title:"Special:Categories"}},[e._v("Category")]),e._v(":")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"/index.php?title=Category:Code",title:"Category:Code"}},[e._v("Code")])])])],1)}),[],!1,null,null,null);t.default=a.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[293],{650:function(e,t,a){"use strict";a.r(t);var n=a(28),r=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("C++ Mutator Tutorial - Epic Wiki")]),e._v(" "),a("h1",{attrs:{id:"c-mutator-tutorial"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c-mutator-tutorial"}},[e._v("#")]),e._v(" C++ Mutator Tutorial")]),e._v(" "),a("h2",{attrs:{id:"contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contents"}},[e._v("#")]),e._v(" Contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#C.2B.2B_Mutator_Tutorial"}},[e._v("1 C++ Mutator Tutorial")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#Requirements"}},[e._v("1.1 Requirements")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Directory_Structure"}},[e._v("1.2 Directory Structure")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#UPlugin_File"}},[e._v("1.3 UPlugin File")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Build.cs_File"}},[e._v("1.4 Build.cs File")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Header_File"}},[e._v("1.5 Header File")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Plugin_Module_Interface"}},[e._v("1.6 Plugin Module Interface")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#The_Mutator"}},[e._v("1.7 The Mutator")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Building_your_Mutator"}},[e._v("1.8 Building your Mutator")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#Testing_your_Mutator"}},[e._v("1.9 Testing your Mutator")])])])])]),e._v(" "),a("h1",{attrs:{id:"c-mutator-tutorial-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c-mutator-tutorial-2"}},[e._v("#")]),e._v(" C++ Mutator Tutorial")]),e._v(" "),a("p",[e._v("This tutorial will teach you how to make a simple mutator for UT using C++. We'll be making a UE4 plugin that defines a child class of AUTMutator.")]),e._v(" "),a("h2",{attrs:{id:"requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),a("ul",[a("li",[e._v("Engine version: 4.3")]),e._v(" "),a("li",[e._v("Skill level: intermediate C++ knowledge")])]),e._v(" "),a("h2",{attrs:{id:"directory-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#directory-structure"}},[e._v("#")]),e._v(" Directory Structure")]),e._v(" "),a("ul",[a("li",[e._v("If UnrealTournament\\Plugins does not already exist, create it")]),e._v(" "),a("li",[e._v('Create a directory inside of UnrealTournament\\Plugins to hold our mutator, in this case it would be "SampleMutator"')]),e._v(" "),a("li",[e._v('Create a "Source" directory inside of the SampleMutator directory')]),e._v(" "),a("li",[e._v('Create a "SampleMutator" directory inside of the "Source" directory')]),e._v(" "),a("li",[e._v('Finally create a "Public" directory and a "Private" directory inside of the last "SampleMutator" directory that we made')])]),e._v(" "),a("h2",{attrs:{id:"uplugin-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uplugin-file"}},[e._v("#")]),e._v(" UPlugin File")]),e._v(" "),a("ul",[a("li",[e._v("We need to create SampleMutator.uplugin to let UE4 know we have a plugin it should load.")]),e._v(" "),a("li",[e._v("On Windows, one way to do this is to create a new text file and rename the file extension to .uplugin. Copying an existing .uplugin file and editing it may not work!")]),e._v(" "),a("li",[e._v("It should live at the same level that the Source directory does")])]),e._v(" "),a("p",[a("strong",[e._v("SampleMutator.uplugin")]),e._v(" - Plugin defintion")]),e._v(" "),a("p",[e._v('{\n"FileVersion" : 3,\n \n"FriendlyName" : "Sample Mutator",\n"Version" : 1,\n"VersionName" : "1.0",\n"CreatedBy" : "Epic Games, Inc.",\n"CreatedByURL" : "http://epicgames.com",\n"EngineVersion" : "4.3.0",\n"Description" : "Sample Mutator",\n"Category" : "UnrealTournament.Mutator",\n"EnabledByDefault" : false,\n \n"Modules" :\n[\n{\n"Name" : "SampleMutator",\n"Type" : "Runtime",\n"WhitelistPlatforms" : [ "Win32", "Win64" ]\n}\n]\n}')]),e._v(" "),a("h2",{attrs:{id:"build-cs-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-cs-file"}},[e._v("#")]),e._v(" Build.cs File")]),e._v(" "),a("ul",[a("li",[e._v("We need to create SampleMutator.Build.cs so that Unreal Build tool knows how to generate our dll file")]),e._v(" "),a("li",[e._v("It should live at the same level that the Public and Private directories do")]),e._v(" "),a("li",[e._v("We'll use the PrivateIncludesPaths array to make #include cleaner throughout our source files")])]),e._v(" "),a("p",[a("strong",[e._v("SampleMutator.Build.cs")]),e._v(" - Unreal Build Tool definitions")]),e._v(" "),a("p",[e._v('namespace UnrealBuildTool.Rules\n{\npublic class SampleMutator : ModuleRules\n{\npublic SampleMutator(TargetInfo Target)\n{\nPrivateIncludePaths.Add("SampleMutator/Private");\n \nPublicDependencyModuleNames.AddRange(\nnew string[]\n{\n"Core",\n"CoreUObject",\n"Engine",\n"UnrealTournament",\n}\n);\n}\n}\n}')]),e._v(" "),a("h2",{attrs:{id:"header-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#header-file"}},[e._v("#")]),e._v(" Header File")]),e._v(" "),a("ul",[a("li",[e._v("Unreal Build Tool requires that we have a shared header file as the first include in every cpp source file in the plugin.")]),e._v(" "),a("li",[e._v("We'll put the SampleMutator.h header file inside of the Private directory")]),e._v(" "),a("li",[e._v("We need to #include Core.h, Engine.h and UTMutator.h to have enough defintions to make a child class from AUTMutator\n"),a("ol",[a("li",[e._v('include "SampleMutator.generated.h" is required by Unreal Header Tool')])])]),e._v(" "),a("li",[e._v("We're only overriding CheckRelevance_Implemenation in this example, but more powerful mutators will overload more of the functions exposed by AUTMutator")])]),e._v(" "),a("p",[a("strong",[e._v("SampleMutator.h")]),e._v(" - Sample Mutator class definition")]),e._v(" "),a("p",[e._v('#pragma once\n \n#include "Core.h"\n#include "Engine.h"\n#include "UTMutator.h"\n#include "UTWeapon.h"\n \n#include "SampleMutator.generated.h"\n \nUCLASS(Blueprintable, Meta = (ChildCanTick))\nclass ASampleMutator : public AUTMutator\n{\nGENERATED_UCLASS_BODY()\n \nbool CheckRelevance_Implementation(AActor* Other) OVERRIDE;\n \n \nUPROPERTY()\nTSubclassOf<AUTWeapon> RocketLauncherClass;\n};')]),e._v(" "),a("h2",{attrs:{id:"plugin-module-interface"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#plugin-module-interface"}},[e._v("#")]),e._v(" Plugin Module Interface")]),e._v(" "),a("ul",[a("li",[e._v("Create SampleMutatorPlugin.cpp inside of the Public directory")]),e._v(" "),a("li",[e._v("There's not much interesting in this file, it just provides UE4 a way to load this mutator as a plugin so I'm going to gloss over this file")]),e._v(" "),a("li",[e._v("Note that SampleMutator.h must be the first #include and the IMPLEMENT_MODULE macro does all the heavy lifting")])]),e._v(" "),a("p",[a("strong",[e._v("SampleMutatorPlugin.cpp")]),e._v(" - Plugin Module Interface")]),e._v(" "),a("p",[e._v('#include "SampleMutator.h"\n \n#include "Core.h"\n#include "Engine.h"\n#include "ModuleManager.h"\n#include "ModuleInterface.h"\n \nclass FSampleMutatorPlugin : public IModuleInterface\n{\n/** IModuleInterface implementation */\nvirtual void StartupModule() override;\nvirtual void ShutdownModule() override;\n};\n \nIMPLEMENT_MODULE( FSampleMutatorPlugin, SampleMutator )\n \nvoid FSampleMutatorPlugin::StartupModule()\n{\n \n}\n \n \nvoid FSampleMutatorPlugin::ShutdownModule()\n{\n \n}')]),e._v(" "),a("h2",{attrs:{id:"the-mutator"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-mutator"}},[e._v("#")]),e._v(" The Mutator")]),e._v(" "),a("ul",[a("li",[e._v("This sample is going to replace all weapon pickups with Rocket Launcher pickups\n"),a("ul",[a("li",[e._v("We'll accomplish that by overriding the CheckRelevance_Implementation function and watching for AUTPickupWeapon")]),e._v(" "),a("li",[e._v("When we find a AUTPickupWeapon, we'll replace its WeaponType reference with a reference to BP_RocketLauncher_C")])])]),e._v(" "),a("li",[e._v("Our mutator is going to live in SampleMutator.cpp inside the Public directory")]),e._v(" "),a("li",[e._v("Note that once again SampleMutator.h has to be the first #include")]),e._v(" "),a("li",[e._v("Our constructor is blank, but feel free to put initialization code in there in a future plugin")]),e._v(" "),a("li",[e._v("StaticLoadClass is used to get the reference to Blueprint'/Game/RestrictedAssets/Weapons/RocketLauncher/BP_RocketLauncher.BP_RocketLauncher_C'\n"),a("ul",[a("li",[e._v("The use of a hardcoded reference here is very brittle and not considered good design, a mutator that requires direct blueprint references might be more easily implemented in blueprints")])])]),e._v(" "),a("li",[e._v("Calling Super::CheckRelevance_Implementation(Other) is highly recommended as failing to do so won't call other mutators in the mutator list")])]),e._v(" "),a("p",[a("strong",[e._v("SampleMutator.cpp")]),e._v(" - Replace all weapon pickups with rocket launcher pickups")]),e._v(" "),a("p",[e._v('#include "SampleMutator.h"\n \n#include "UTPickupWeapon.h"\n \nASampleMutator::ASampleMutator(const FPostConstructInitializeProperties& PCIP)\n: Super(PCIP)\n{\n}\n \nbool ASampleMutator::CheckRelevance_Implementation(AActor* Other)\n{\n// Find the rocket launcher blueprint\nif (RocketLauncherClass == nullptr)\n{\nRocketLauncherClass = StaticLoadClass(AUTWeapon::StaticClass(), nullptr, TEXT("Blueprint\'/Game/RestrictedAssets/Weapons/RocketLauncher/BP_RocketLauncher.BP_RocketLauncher_C\'"));\n}\n \n// If a weapon pickup has a current weapon type, replace it with the rocket launcher\nAUTPickupWeapon *PickupWeapon = Cast<AUTPickupWeapon>(Other);\nif (PickupWeapon)\n{\nif (PickupWeapon->WeaponType != nullptr)\n{\nPickupWeapon->WeaponType = RocketLauncherClass;\n}\n}\n \nreturn Super::CheckRelevance_Implementation(Other);\n}')]),e._v(" "),a("h2",{attrs:{id:"building-your-mutator"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#building-your-mutator"}},[e._v("#")]),e._v(" Building your Mutator")]),e._v(" "),a("ul",[a("li",[e._v('Right click your UnrealTournament.uproject in Window Explorer and select "Generate Visual Studio project files"')]),e._v(" "),a("li",[e._v("Open up the Unreal Tournament solution file in Visual Studio")]),e._v(" "),a("li",[e._v("Build the Unreal Tournament project in Development Editor configuration")]),e._v(" "),a("li",[e._v("You will notice that in addition to UE4Editor-UnrealTournament.dll, UnrealTournament\\Plugins\\SampleMutator\\Binaries\\Win64\\UE4Editor-SampleMutator.dll was generated")])]),e._v(" "),a("h2",{attrs:{id:"testing-your-mutator"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing-your-mutator"}},[e._v("#")]),e._v(" Testing your Mutator")]),e._v(" "),a("ul",[a("li",[e._v('Run from a commandline "UE4Editor.exe UnrealTournament -game Example_Map?mutator=SampleMutator.SampleMutator"')]),e._v(" "),a("li",[e._v("You should notice that the weapon pickups in the map have been replaced by Rocket Launchers")])]),e._v(" "),a("p",[e._v('Retrieved from "'),a("a",{attrs:{href:"https://wiki.unrealengine.com/index.php?title=C%2B%2B_Mutator_Tutorial&oldid=15713",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://wiki.unrealengine.com/index.php?title=C%2B%2B_Mutator_Tutorial&oldid=15713"),a("OutboundLink")],1),e._v('"')]),e._v(" "),a("p",[a("a",{attrs:{href:"/Special:Categories",title:"Special:Categories"}},[e._v("Categories")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"/Category:Unreal_Tournament",title:"Category:Unreal Tournament"}},[e._v("Unreal Tournament")])]),e._v(" "),a("li",[a("a",{attrs:{href:"/Category:UT_Content_Creation",title:"Category:UT Content Creation"}},[e._v("UT Content Creation")])])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://tracking.unrealengine.com/track.png",alt:""}})])])}),[],!1,null,null,null);t.default=r.exports}}]);
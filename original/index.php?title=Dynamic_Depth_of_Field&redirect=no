<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" /><title>Dynamic Depth of Field - Epic Wiki</title>
<meta name="generator" content="MediaWiki 1.22.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Epic Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.unrealengine.com/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Epic Wiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.vector&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: my_wiki:resourceloader:filter:minify-css:7:07b6a8ccf3fd62e770f192d0a6f8e123 */</style>

<script src="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Dynamic_Depth_of_Field","wgTitle":"Dynamic Depth of Field","wgCurRevisionId":6570,"wgRevisionId":6570,"wgArticleId":1403,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Tutorials","Blueprint"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Dynamic_Depth_of_Field","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"templateEditor":false,"templates":false,"preview":true,"previewDialog":false,"publish":true,"toc":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: my_wiki:resourceloader:filter:minify-js:7:27249162ef7002415c3792ce5dfd2a9a */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Dynamic_Depth_of_Field skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Dynamic Depth of Field</span></h1>
			<div id="bodyContent">
								<div id="siteSub">From Epic Wiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Blueprint_Setup"><span class="tocnumber">2</span> <span class="toctext">Blueprint Setup</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Events"><span class="tocnumber">2.1</span> <span class="toctext">Events</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Trace_Hit_Result_and_Focus_Distance"><span class="tocnumber">2.2</span> <span class="toctext">Trace Hit Result and Focus Distance</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Post_Process_Settings"><span class="tocnumber">2.3</span> <span class="toctext">Post Process Settings</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Final_Result_and_Notes"><span class="tocnumber">3</span> <span class="toctext">Final Result and Notes</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Overview">Overview</span></h2>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:568px;"><a href="/File:DoF_5.jpg" class="image"><img alt="DoF 5.jpg" src="https://d26ilriwvtzlb.cloudfront.net/e/e9/DoF_5.jpg" width="566" height="285" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div></div>
<p>Dynamic depth of field is an effect that can be used in FPS games to blur the background while reloading a weapon or focusing on the target as the player aims through iron sights of their weapon while blurring the rest of the screen. It can also be used to create a camera that you can use for taking screenshots for portfolio or any other reason you would want DoF effect without bothering with all the post process adjustments every time.
</p><p>Here I'll give you the bare bones of how to implement this effect to a player camera using <b>TP_FirstPersonBP</b> template project, which later on you can implement on any camera and change the settings depending on your needs.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Blueprint_Setup">Blueprint Setup</span></h2>
<div class="thumb tleft"><div class="thumbinner" style="width:362px;"><a href="/File:DoF_6.JPG" class="image"><img alt="DoF 6.JPG" src="https://d3ar1piqh1oeli.cloudfront.net/6/6e/DoF_6.JPG/360px-DoF_6.JPG" width="360" height="131" class="thumbimage" srcset="https://d3ar1piqh1oeli.cloudfront.net/6/6e/DoF_6.JPG/540px-DoF_6.JPG 1.5x, https://d3ar1piqh1oeli.cloudfront.net/6/6e/DoF_6.JPG/720px-DoF_6.JPG 2x" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/File:DoF_6.JPG" class="internal" title="Enlarge"><img src="/skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div></div></div></div>
<p><br clear="all" />
</p><p>Here you can see the overall network inside the character blueprint's Event graph, if you have experience with Blueprints and just want to get the network and recreate it right away.
Now more details.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Events">Events</span></h3>
<div class="thumb tleft"><div class="thumbinner" style="width:921px;"><a href="/File:DoF_7.JPG" class="image"><img alt="DoF 7.JPG" src="https://d26ilriwvtzlb.cloudfront.net/2/21/DoF_7.JPG" width="919" height="592" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div>
<p><br clear="all" />
</p><p>We are going to be using two events, <b>Event Tick</b> and an <b>Input</b> event. We don't want to have this effect all the time in this case, so we use <b>Right Mouse Button</b> to enable Tick to fire a <i>line trace</i> from the camera which will tell us if/where/which object is the center of focus. And when we release the input, it will reverse the Timeline and stop the effect. Event Tick will also update the camera's post process settings as we will see in the following sections.
</p><p>Trace Distance node is a collapsed graph to reduce the crowd in the network. You can see the expanded view down below:
</p>
<div class="thumb tleft"><div class="thumbinner" style="width:722px;"><a href="/File:Collapsed_TraceDistance.JPG" class="image"><img alt="Collapsed TraceDistance.JPG" src="https://d3ar1piqh1oeli.cloudfront.net/0/0f/Collapsed_TraceDistance.JPG/720px-Collapsed_TraceDistance.JPG" width="720" height="315" class="thumbimage" srcset="https://d3ar1piqh1oeli.cloudfront.net/0/0f/Collapsed_TraceDistance.JPG/1080px-Collapsed_TraceDistance.JPG 1.5x, https://d26ilriwvtzlb.cloudfront.net/0/0f/Collapsed_TraceDistance.JPG 2x" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/File:Collapsed_TraceDistance.JPG" class="internal" title="Enlarge"><img src="/skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div></div></div></div>
<p><br clear="all" />
</p><p>Return Value 1 is the camera's location and 5000 is the distance we are going to be tracing. 
</p><p><br />
</p>
<h3><span class="mw-headline" id="Trace_Hit_Result_and_Focus_Distance">Trace Hit Result and Focus Distance</span></h3>
<div class="thumb tleft"><div class="thumbinner" style="width:605px;"><a href="/File:DoF_8.JPG" class="image"><img alt="DoF 8.JPG" src="https://d26ilriwvtzlb.cloudfront.net/2/2a/DoF_8.JPG" width="603" height="543" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div>
<p><br clear="all" />
</p><p>We are going to use a 1 second long <b>Timeline</b> track going from 0.0 to 0.5 to set the intensity of depth of field effect(which basically activates/deactivates the effect)
After a trace happens every tick we check the return value(boolean).If it is true then it continues the rest of the calculations. If not, it reverses the Timeline to stop the effect.
</p><p>Considering the trace hit an object, we break that result so that we can get the <b>Hit Location</b>. And to get the distance between the camera and the hit location we will use a macro like this:
</p>
<div class="thumb tleft"><div class="thumbinner" style="width:722px;"><a href="/File:FocusDistance_Macro.JPG" class="image"><img alt="FocusDistance Macro.JPG" src="https://d26ilriwvtzlb.cloudfront.net/8/83/FocusDistance_Macro.JPG" width="720" height="361" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/File:FocusDistance_Macro.JPG" class="internal" title="Enlarge"><img src="/skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div></div></div></div>
<p><br clear="all" />
</p><p>Or, you can use Get Length node instead if you prefer. Subtract location of the camera from focus location and get the length of that output, and you will get the distance.
</p><p><br />
Now that we have the information we need we can use it to manipulate our camera's depth of field settings.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Post_Process_Settings">Post Process Settings</span></h3>
<div class="thumb tleft"><div class="thumbinner" style="width:1183px;"><a href="/File:DoF_9.JPG" class="image"><img alt="DoF 9.JPG" src="https://d26ilriwvtzlb.cloudfront.net/9/9e/DoF_9.JPG" width="1181" height="692" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div>
<p><br clear="all" />
</p><p>First we get the post process settings of the camera, which will give us the last focal distance so that we can use it for a soft blend when the trace hits points too far from each other.
</p><p>To get the Break/Make post process nodes;
</p>
<ol>
<li> <b>Get First Person Camera</b>
</li>
<li> Drag from first person camera and <b>Get Post Process Settings</b>
</li>
<li> Drag from post process settings and you'll see <b>Break and Make PostProcessSettings</b> nodes
</li>
</ol>
<p>Now in the details panel of Break Postprocesssettings node enable only Depth of Field Focal Distance setting. Currently(version 4.1.1) post process setting nodes are a little messy so you'll have to turn all of the rest of the settings manually for easier control. When we drag from Depth of Field Focal Distance and <b>Set</b> the variable(named <i>Last Focus</i>) it gets stored as the last focal distance.
And finally in order to get a smooth blend between the last focus distance and the current hit location we use <b>FInterp To</b> node. 
</p><p><br />
</p>
<h2><span class="mw-headline" id="Final_Result_and_Notes">Final Result and Notes</span></h2>
<p>When it's all done, this is what you will get every time you press and hold the right mouse button:
</p><p><a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=rEargI8dNFk">Final Result</a>
</p><p><b>Notes:</b>
</p>
<ul>
<li> Setting the interp speed depending on the distance is optional, but highly suggested.
</li>
<li> You can adjust Near and Far Transition depending on how you want it to look like. Add distance for softer transition / Subtract distance for sharper transition.
</li>
</ul>

<!-- 
NewPP limit report
CPU time usage: 0.073 seconds
Real time usage: 0.342 seconds
Preprocessor visited node count: 28/1000000
Preprocessor generated node count: 40/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key my_wiki:pcache:idhash:1403-0!*!*!!en!2!* and timestamp 20140824023727
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="https://wiki.unrealengine.com/index.php?title=Dynamic_Depth_of_Field&amp;oldid=6570">https://wiki.unrealengine.com/index.php?title=Dynamic_Depth_of_Field&amp;oldid=6570</a>"				</div>
												<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/Category:Tutorials" title="Category:Tutorials">Tutorials</a></li><li><a href="/Category:Blueprint" title="Category:Blueprint">Blueprint</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-createaccount"><a href="/index.php?title=Special:UserLogin&amp;returnto=Dynamic+Depth+of+Field&amp;returntoquery=redirect%3Dno&amp;type=signup">Create account</a></li><li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=Dynamic+Depth+of+Field&amp;returntoquery=redirect%3Dno" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="/Dynamic_Depth_of_Field"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="/index.php?title=Talk:Dynamic_Depth_of_Field&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="/Dynamic_Depth_of_Field" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="/index.php?title=Dynamic_Depth_of_Field&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="/index.php?title=Dynamic_Depth_of_Field&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="/index.php" id="searchform">
				<div id="simpleSearch">
						<input name="search" placeholder="Search" title="Search Epic Wiki [f]" accesskey="f" id="searchInput" />						<button type="submit" name="button" title="Search the pages for this text" id="searchButton"><img src="/skins/vector/images/search-ltr.png?303" alt="Search" width="12" height="13" /></button>								<input type='hidden' name="title" value="Special:Search"/>
		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(/images/WikiLogo_uev2.png);" href="/Main_Page"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage"><a href="/Main_Page" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
			<li id="n-Tutorials"><a href="/Category:Tutorials">Tutorials</a></li>
			<li id="n-Videos"><a href="/Videos">Videos</a></li>
			<li id="n-Plug-ins"><a href="/Category:Plug-ins">Plug-ins</a></li>
			<li id="n-Code"><a href="/Category:Code">Code</a></li>
			<li id="n-Games"><a href="/Category:Games">Games</a></li>
			<li id="n-Unreal-Tournament"><a href="/Category:Unreal_Tournament">Unreal Tournament</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="/Special:WhatLinksHere/Dynamic_Depth_of_Field" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="/Special:RecentChangesLinked/Dynamic_Depth_of_Field" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="/index.php?title=Dynamic_Depth_of_Field&amp;redirect=no&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="/index.php?title=Dynamic_Depth_of_Field&amp;oldid=6570" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="/index.php?title=Dynamic_Depth_of_Field&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
										<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<div name="copyright">&#169; 2004-2014, Epic Games, Inc. All rights reserved. Epic Games, Unreal, Unreal Engine, Unreal Tournament, and their respective logos are Epic's trademarks or registered trademarks in the US and elsewhere.</div>
					</li>
					<li id="footer-termsofuseico">
						<div name="termsofuse"><a href="http://epicgames.com/tou" target="_blank">Terms of Use</a></div>
					</li>
					<li id="footer-privacynoticeico">
						<div name="privacynotice"><a href="http://epicgames.com/privacynotice" target="_blank">Privacy Policy</a></div>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<!-- Served in 0.076 secs. -->
	</body>
</html>

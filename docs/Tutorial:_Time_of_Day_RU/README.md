Урок: Время суток - Epic Wiki                     

Урок: Время суток
=================

(Redirected from [Tutorial: Time of Day RU](/index.php?title=Tutorial:_Time_of_Day_RU&redirect=no "Tutorial: Time of Day RU"))

**Rate this Article:**

4.71

![](/extensions/VoteNY/images/star_on.gif)![](/extensions/VoteNY/images/star_on.gif)![](/extensions/VoteNY/images/star_on.gif)![](/extensions/VoteNY/images/star_on.gif)![](/extensions/VoteNY/images/star_half.gif) (7 votes)

Approved for Versions:(please verify)

Contents
--------

*   [1 Вступление](#.D0.92.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5)
*   [2 Создание уровня](#.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F)
*   [3 Настройка освещения](#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D0.BE.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D1.8F)
*   [4 Работа с Blueprint](#.D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81_Blueprint)
    *   [4.1 Что делает данный код?](#.D0.A7.D1.82.D0.BE_.D0.B4.D0.B5.D0.BB.D0.B0.D0.B5.D1.82_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BA.D0.BE.D0.B4.3F)
*   [5 Заключительные шаги](#.D0.97.D0.B0.D0.BA.D0.BB.D1.8E.D1.87.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5_.D1.88.D0.B0.D0.B3.D0.B8)
*   [6 Использование динамического Global Illumination](#.D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B4.D0.B8.D0.BD.D0.B0.D0.BC.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_Global_Illumination)
*   [7 Поиск и устранение ошибок](#.D0.9F.D0.BE.D0.B8.D1.81.D0.BA_.D0.B8_.D1.83.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BE.D1.88.D0.B8.D0.B1.D0.BE.D0.BA)
    *   [7.1 Ничего не происходит, когда я нажимаю играть; Время стоит на месте!](#.D0.9D.D0.B8.D1.87.D0.B5.D0.B3.D0.BE_.D0.BD.D0.B5_.D0.BF.D1.80.D0.BE.D0.B8.D1.81.D1.85.D0.BE.D0.B4.D0.B8.D1.82.2C_.D0.BA.D0.BE.D0.B3.D0.B4.D0.B0_.D1.8F_.D0.BD.D0.B0.D0.B6.D0.B8.D0.BC.D0.B0.D1.8E_.D0.B8.D0.B3.D1.80.D0.B0.D1.82.D1.8C.3B_.D0.92.D1.80.D0.B5.D0.BC.D1.8F_.D1.81.D1.82.D0.BE.D0.B8.D1.82_.D0.BD.D0.B0_.D0.BC.D0.B5.D1.81.D1.82.D0.B5.21)
    *   [7.2 Угол освещения меняется, но видимое солнце не двигается, и небо не меняется от дня к ночи! Или: Есть звезды на небе, даже в течение дня!](#.D0.A3.D0.B3.D0.BE.D0.BB_.D0.BE.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BC.D0.B5.D0.BD.D1.8F.D0.B5.D1.82.D1.81.D1.8F.2C_.D0.BD.D0.BE_.D0.B2.D0.B8.D0.B4.D0.B8.D0.BC.D0.BE.D0.B5_.D1.81.D0.BE.D0.BB.D0.BD.D1.86.D0.B5_.D0.BD.D0.B5_.D0.B4.D0.B2.D0.B8.D0.B3.D0.B0.D0.B5.D1.82.D1.81.D1.8F.2C_.D0.B8_.D0.BD.D0.B5.D0.B1.D0.BE_.D0.BD.D0.B5_.D0.BC.D0.B5.D0.BD.D1.8F.D0.B5.D1.82.D1.81.D1.8F_.D0.BE.D1.82_.D0.B4.D0.BD.D1.8F_.D0.BA_.D0.BD.D0.BE.D1.87.D0.B8.21_.D0.98.D0.BB.D0.B8:_.D0.95.D1.81.D1.82.D1.8C_.D0.B7.D0.B2.D0.B5.D0.B7.D0.B4.D1.8B_.D0.BD.D0.B0_.D0.BD.D0.B5.D0.B1.D0.B5.2C_.D0.B4.D0.B0.D0.B6.D0.B5_.D0.B2_.D1.82.D0.B5.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B4.D0.BD.D1.8F.21)
    *   [7.3 Солнце движется слишком быстро!](#.D0.A1.D0.BE.D0.BB.D0.BD.D1.86.D0.B5_.D0.B4.D0.B2.D0.B8.D0.B6.D0.B5.D1.82.D1.81.D1.8F_.D1.81.D0.BB.D0.B8.D1.88.D0.BA.D0.BE.D0.BC_.D0.B1.D1.8B.D1.81.D1.82.D1.80.D0.BE.21)
*   [8 Изменение среды](#.D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D1.80.D0.B5.D0.B4.D1.8B)
    *   [8.1 Краткий обзор:](#.D0.9A.D1.80.D0.B0.D1.82.D0.BA.D0.B8.D0.B9_.D0.BE.D0.B1.D0.B7.D0.BE.D1.80:)
    *   [8.2 Используем переменную "Ночь".](#.D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D1.83.D0.B5.D0.BC_.D0.BF.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.BD.D1.83.D1.8E_.22.D0.9D.D0.BE.D1.87.D1.8C.22.)
*   [9 Заключение](#.D0.97.D0.B0.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5)
*   [10 Русское сообщество Unreal Engine 4](#.D0.A0.D1.83.D1.81.D1.81.D0.BA.D0.BE.D0.B5_.D1.81.D0.BE.D0.BE.D0.B1.D1.89.D0.B5.D1.81.D1.82.D0.B2.D0.BE_Unreal_Engine_4)

Вступление
----------

Здравствуйте, в данном уроке мы научимся создавать динамические времена суток(день и ночь). Это не сложный процесс, но у вас должны быть базовые знания редактора Unreal Engine 4 и небольшой опыт работы с Blueprint.

Создание уровня
---------------

Создайте новый уровень. (Вы также можете использовать готовый уровень, но убедитесь, что он имеет **SkyDome** и **directional light** ). Так же вы можете добавить несколько объектов, что бы увидеть некоторые тени от солнца.

[![TODTut BaseScene.JPG](https://d3ar1piqh1oeli.cloudfront.net/4/4b/TODTut_BaseScene.JPG/500px-TODTut_BaseScene.JPG)](/File:TODTut_BaseScene.JPG)

Настройка освещения
-------------------

Следующий этап данного урока, это настройка освещения. Выберите Dominant **Directional Light** и перейдите к панели деталей и свойств (details panel).

В блоке "Transform" измените состояние свойства "**Mobility**" на "**Movable**.". Это добавит динамические тени на сцену.

[![TODTut_MovableSun.jpg](https://d26ilriwvtzlb.cloudfront.net/9/99/TODTut_MovableSun.jpg)](/File:TODTut_MovableSun.jpg "TODTut_MovableSun.jpg")

Так же, необходимо убрать галочку с "**Cast Static Shadows**".

Работа с Blueprint
------------------

Чтобы действительно получить динамическое время суток, мы должны использовать Blueprint - необходимо вращать наше "солнце". Вы можете использовать Matinee или Timeline, но здесь мы будем просто вращать наше "солнце" каждый кадр.

[![TODTut_LevelBlueprint.JPG](https://d26ilriwvtzlb.cloudfront.net/3/3b/TODTut_LevelBlueprint.JPG)](/File:TODTut_LevelBlueprint.JPG "TODTut_LevelBlueprint.JPG")

### Что делает данный код?

*   Каждый "Тик", или кадр, мы вращаем наше "солнце" на определенный градус;
*   "SUNSPEED" - контролирует скорость, с которой солнце вращается вокруг мира. Умножим его на DeltaTime так, чтобы частота кадров не повлияла на эту скорость. Установка этого значения в 30 дает хорошую скорость.
*   "Update Sun Direction" узел меняет небо, основанный на вращении Солнца. Это функция встроена в класс SkyDome, который должен быть вызван каждый Тик(кадр). (ПРИМЕЧАНИЕ: Вы должны выбрать Skydome в 3D окне, чтобы добавить этот узел в план.) Для получения дополнительной информации об этой функции, проверить класс Skydome.

Заключительные шаги
-------------------

Перед тестирования нашей работы, пересчитайте освещение мира. После чего можете запустить симуляцию и увидеть, как проходят времена суток (рассвет/день/сумерки/ночь) и как динамично меняется освещение и как просчитываются тени объектов.

Использование динамического Global Illumination
-----------------------------------------------

Динамическую систему суток лучше использовать вместе с Global Illumination (GI). Хотя эта функция работает пока еще не в полном объеме, но вы можете найти информацию о ней [здесь](https://wiki.unrealengine.com/Light_Propagation_Volumes_GI).

Поиск и устранение ошибок
-------------------------

### Ничего не происходит, когда я нажимаю играть; Время стоит на месте!

Убедитесь, что вы установили солнцу значение "Movable", и что "Cast Static Shadows" - отключена. Кроме того, убедитесь, что ваш "SUNSPEED" в Blueprint устанавливается в достаточно большое число. (Я рекомендую 30 для отладки.)

### Угол освещения меняется, но видимое солнце не двигается, и небо не меняется от дня к ночи! Или: Есть звезды на небе, даже в течение дня!

Это означает, что вы не создали "Update Sun Direction" узел должным образом в вашем скрипте. Эта функция должна вызываться при каждом тике. Если вы не видите возможность добавить эту функцию, убедитесь, что у вас есть свой ​​**skydome**.

### Солнце движется слишком быстро!

Скорость солнца контролируется переменной "SUNSPEED" в вашем скрипте. Значение этого параметра устанавливает сколько градусов солнце будет вращаться в одну секунду. Например, при значении "SUNSPEED" в 90, это займет 4 секунды, что бы прошли сутки. Просто сократить это значение, чтобы замедлить движение солнца.

Изменение среды
---------------

В данном коде, мы определяем наше время суток: день это или ночь. Вы можете иметь способ для уровня знать, является ли это ночь или день. Если вы используете Matinee, это довольно легко сделать; просто поставить пользовательские события, чтобы вызвать желаемые результаты. Однако, если вы используете метод, который я продемонстрировал выше, это может быть сложнее.

[![TODTut_GetSunRotation.JPG](https://d26ilriwvtzlb.cloudfront.net/f/fc/TODTut_GetSunRotation.JPG)](/File:TODTut_GetSunRotation.JPG "TODTut_GetSunRotation.JPG")

### Краткий обзор:

*   Прежде всего, мы получаем вращение нашей лампы.
*   Затем мы проверяем, если это ниже горизонта.
*   "Ночной Порог" позволяет нам указать на сколько градусов ниже горизонта солнце должно быть, прежде чем мы перейдем на "ночь".
*   Затем мы устанавливаем "Ночь", чтобы отразить наш результат. Теперь мы можем использовать эту переменную, чтобы сделать логические решения.

### Используем переменную "Ночь".

Теперь нам нужно использовать переменную "Ночь". Мы создали некоторые отдаленные события, вызываемый при изменении состояния от дня к ночи:

[![TODTut_SetupNightEvents.jpg](https://d26ilriwvtzlb.cloudfront.net/6/66/TODTut_SetupNightEvents.jpg)](/File:TODTut_SetupNightEvents.jpg "TODTut_SetupNightEvents.jpg")

*   Прежде всего: что "Установить: Night" узел в начале такая же, как самый правый узел от последнего скриншота. (Не добавляйте его снова.)
*   "LastFrameNight" - определяет текущее время суток: день или ночь. Если этого не сделать, то все события связанные со временем суток, вызовутся каждый раз.
*   Затем мы проверяем, время суток и вызываем соответственный удаленный метод

Вы можете делать все, что вы хотите с удаленными событиями, например, включать различные звуки окр. среды и так далее. Вот мои настройки пользовательских событий:

[![TODTut_ChangeTheSun.jpg](https://d26ilriwvtzlb.cloudfront.net/5/5b/TODTut_ChangeTheSun.jpg)](/File:TODTut_ChangeTheSun.jpg "TODTut_ChangeTheSun.jpg")

Заключение
----------

Если вы хотите использовать более сложные события дня и ночи, лучше использовать Matinee. Вы будете иметь гораздо больший контроль над всем процессом.

Русское сообщество Unreal Engine 4
----------------------------------

[Русское сообщество Unreal Engine 4](http://ue4.codengine.ru)

[Уроки по Unreal Engine 4 на Русском](http://ue4.codengine.ru/index.php/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%A3%D1%80%D0%BE%D0%BA%D0%B8)

[Ссылка на русское сообщество](http://ue4.codengine.ru/index.php/%D0%92%D1%80%D0%B5%D0%BC%D1%8F_%D1%81%D1%83%D1%82%D0%BE%D0%BA)

Перевел [Дмитрий Кулик](http://vk.com/sentike)

Retrieved from "[https://wiki.unrealengine.com/index.php?title=Урок:\_Время\_суток&oldid=23750](https://wiki.unrealengine.com/index.php?title=Урок:_Время_суток&oldid=23750)"

[Categories](/Special:Categories "Special:Categories"):

*   [Уроки](/Category:%D0%A3%D1%80%D0%BE%D0%BA%D0%B8 "Category:Уроки")
*   [Tutorials](/Category:Tutorials "Category:Tutorials")
*   [Blueprint](/Category:Blueprint "Category:Blueprint")
*   [Community Created Content](/Category:Community_Created_Content "Category:Community Created Content")
*   [Русское сообщество](/Category:%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%BE%D0%B5_%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%BE "Category:Русское сообщество")

Hidden category:

*   [Templates](/Category:Templates "Category:Templates")

  ![](https://tracking.unrealengine.com/track.png)